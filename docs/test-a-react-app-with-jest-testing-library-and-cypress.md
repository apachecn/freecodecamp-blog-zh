# å¦‚ä½•ä½¿ç”¨ Jestã€Testing Libraryã€Cypress å’Œ Supertest æµ‹è¯•ä½ çš„åº”ç”¨

> åŸæ–‡ï¼š<https://www.freecodecamp.org/news/test-a-react-app-with-jest-testing-library-and-cypress/>

å¤§å®¶å¥½ï¼åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è°ˆè®ºæµ‹è¯•ã€‚æˆ‘å°†å¯¹ä»€ä¹ˆæ˜¯æµ‹è¯•åšä¸€ä¸ªå¾ˆå¥½çš„æ¦‚è¿°ï¼Œå¹¶ä»‹ç»å¦‚ä½•åœ¨ JavaScript é¡¹ç›®ä¸­å®ç°æµ‹è¯•ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å››ä¸ªéå¸¸æµè¡Œçš„å·¥å…·â€”â€”Jestã€æµ‹è¯•åº“ã€Cypress å’Œ Supertestã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†è®¨è®ºä»€ä¹ˆæ˜¯æµ‹è¯•ï¼Œä¸ºä»€ä¹ˆæµ‹è¯•æˆ‘ä»¬çš„ä»£ç æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä»¥åŠå¯ä»¥å®ç°çš„ä¸åŒç§ç±»çš„æµ‹è¯•ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ä»‹ç»æˆ‘ä»¬å°†ä½¿ç”¨çš„æ¯ä¸ªå·¥å…·ï¼Œæœ€åï¼Œæˆ‘ä»¬å°†ç»™å‡ºæ™®é€š JS ä»£ç ã€å‰ç«¯ React åº”ç”¨ç¨‹åºå’Œåç«¯ Node åº”ç”¨ç¨‹åºçš„å®é™…ç¤ºä¾‹ã€‚

æˆ‘ä»¬èµ°å§ï¼

## ç›®å½•

*   [ä»€ä¹ˆæ˜¯æµ‹è¯•ï¼Œä¸ºä»€ä¹ˆå®ƒæœ‰ä»·å€¼](#what-is-testing-and-why-is-it-valuable)
*   [ä¸åŒç±»å‹çš„æµ‹è¯•](#different-types-of-tests)
    *   [æ‰‹åŠ¨ä¸è‡ªåŠ¨æµ‹è¯•](#manual-vs-automated-testing)
    *   [åŠŸèƒ½ä¸éåŠŸèƒ½æµ‹è¯•](#functional-vs-non-functional-testing)
    *   [å•å…ƒ vs é›†æˆ vs ç«¯åˆ°ç«¯æµ‹è¯•](#unit-vs-integration-testing-vs-end-to-end-testing)
    *   [ç™½ç›’ vs é»‘ç›’ vs ç°ç›’æµ‹è¯•](#white-box-vs-black-box-vs-grey-box-testing)
*   [ä½•æ—¶æµ‹è¯•](#when-to-test)
*   [æˆ‘ä»¬çš„å·¥å…·é›†](#our-toolset)
    *   [ä»€ä¹ˆæ˜¯ç©ç¬‘](#what-is-jest)
    *   [ä»€ä¹ˆæ˜¯æµ‹è¯•åº“](#what-is-testing-library)
    *   [æŸæ ‘æ˜¯ä»€ä¹ˆ](#what-is-cypress)
    *   [ä»€ä¹ˆæ˜¯è¶…çº§æµ‹è¯•](#what-is-supertest)
    *   [å·¥å…·ç»¼è¿°](#tools-roundup)
*   [å¦‚ä½•æµ‹è¯•é¦™è‰ JS ä»£ç ](#how-to-test-vanilla-js-code)
*   [å¦‚ä½•ç”¨ Jest å’Œ React æµ‹è¯•åº“æµ‹è¯•å‰ç«¯ React app](#how-to-test-a-front-end-react-app-with-jest-and-react-testing-library)
*   [å¦‚ä½•ç”¨ Cypress æµ‹è¯•å‰ç«¯ React app](#how-to-test-a-front-end-react-app-with-cypress)
*   [å¦‚ä½•æµ‹è¯•åç«¯èŠ‚ç‚¹ app](#how-to-test-a-back-end-node-app)
*   [æ€»ç»“](#wrap-up)

# ä»€ä¹ˆæ˜¯æµ‹è¯•ï¼Œä¸ºä»€ä¹ˆå®ƒæœ‰ä»·å€¼

æµ‹è¯•æ˜¯æ£€æŸ¥ä¸€ä¸ªè½¯ä»¶æ˜¯å¦æŒ‰é¢„æœŸè¿è¡Œçš„å®è·µã€‚è¿™é€šå¸¸è¢«è®¤ä¸ºæ˜¯ QA æˆ–è´¨é‡ä¿è¯ï¼Œæ—¨åœ¨å°†è¿›å…¥ç”Ÿäº§çš„ bug æ•°é‡å‡å°‘åˆ°æœ€ä½é™åº¦ã€‚

æˆ‘ä»¬æµ‹è¯•è½¯ä»¶ä»¥è¯†åˆ«é”™è¯¯ã€å·®è·æˆ–ç¼ºå¤±çš„éœ€æ±‚ï¼Œå¹¶åœ¨å°†ä»£ç äº¤ä»˜ç”Ÿäº§ä¹‹å‰ä¿®å¤è¿™äº›é—®é¢˜ã€‚

å½»åº•æµ‹è¯•æˆ‘ä»¬çš„ä»£ç æé«˜äº†æˆ‘ä»¬é¡¹ç›®çš„å¯é æ€§ï¼ŒèŠ‚çœäº†æˆ‘ä»¬ä»¥åä¿®å¤ bug çš„æ—¶é—´ï¼Œä»è€Œé™ä½äº†æˆæœ¬ï¼Œå¹¶å¢åŠ äº†æˆ‘ä»¬çš„å®¢æˆ·å¯¹æˆ‘ä»¬çš„äº§å“å®Œå…¨æ»¡æ„çš„æœºä¼šã€‚

![BvIJ1M5-1](img/a5aeaedae20b6235411e37828b242c55.png)

è¿™é‡Œæœ‰ä¸€ä¸ª Fireship åˆ¶ä½œçš„å¾ˆå¥½çš„çŸ­ç‰‡ä»‹ç»ä¸€äº›æˆ‘ä»¬ç¨åä¼šè°ˆåˆ°çš„æ¦‚å¿µã€‚

# ä¸åŒç±»å‹çš„æµ‹è¯•

æµ‹è¯•å®è·µå¯ä»¥æ ¹æ®è®¸å¤šå› ç´ åˆ†ä¸ºä¸åŒçš„ç±»å‹ã€‚æˆ‘ä¸ªäººè®¤ä¸ºå…³äºè¿™ä¸ªè¯é¢˜æœ‰å¾ˆå¤šæ™¦æ¶©éš¾æ‡‚çš„ä¸œè¥¿ï¼Œæœ‰æ•°ç™¾ä¸ªæœ¯è¯­ç»å¸¸æŒ‡ä»£éå¸¸ç›¸ä¼¼çš„äº‹ç‰©ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ä¿æŒç®€å•ï¼Œåªå›é¡¾æœ€æµè¡Œçš„æœ¯è¯­åŠå…¶å«ä¹‰ã€‚

è¿™å°†æœ‰åŠ©äºé˜æ˜è½¯ä»¶æµ‹è¯•çš„è®¸å¤šæ–¹å¼ï¼Œå¹¶æ›´å¥½åœ°ç†è§£æˆ‘ä»¬ç¨åå°†å±•ç¤ºçš„å·¥å…·ã€‚

### æ‰‹åŠ¨æµ‹è¯•ä¸è‡ªåŠ¨åŒ–æµ‹è¯•

æ ¹æ®æˆ‘ä»¬ç”¨æ¥æµ‹è¯•è½¯ä»¶çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥å°†æµ‹è¯•åˆ†ä¸º**æ‰‹åŠ¨**æˆ–**è‡ªåŠ¨æµ‹è¯•**ã€‚

**æ‰‹åŠ¨æµ‹è¯•**æ˜¯â€œç‚¹å‡»â€å¹¶æ‰‹åŠ¨æ£€æŸ¥æˆ‘ä»¬äº§å“çš„æ‰€æœ‰åŠŸèƒ½çš„å®è·µï¼Œæ¨¡æ‹Ÿå®é™…ç”¨æˆ·ä¼šåšä»€ä¹ˆã€‚

è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯é€šè¿‡ä»£ç æ¥å®Œæˆçš„ï¼Œç¼–å†™ç¨‹åºæ¥æ£€æŸ¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¦‚ä½•è¿è¡Œã€‚

æœ‰è®¸å¤šæµ‹è¯•æ¡†æ¶å’Œåº“å¯ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚å½“è°ˆåˆ°åŠŸèƒ½æµ‹è¯•æ—¶(æˆ‘ä»¬é©¬ä¸Šä¼šçœ‹åˆ°è¿™æ„å‘³ç€ä»€ä¹ˆ)ï¼Œå¤§å¤šæ•°åº“éƒ½ä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œ:

*   é¦–å…ˆæˆ‘ä»¬**å®šä¹‰**æˆ‘ä»¬æƒ³è¦æµ‹è¯•å“ªæ®µä»£ç ã€‚
*   ç„¶åæˆ‘ä»¬ç»™è¿™æ®µä»£ç æä¾›æŸç§ç±»å‹çš„**è¾“å…¥**æˆ–è€…å¯¹å®ƒæ‰§è¡Œä¸€ä¸ª**åŠ¨ä½œ**ã€‚
*   ç„¶åæˆ‘ä»¬å®šä¹‰è¿™æ®µä»£ç **åº”è¯¥åšä»€ä¹ˆ**ç»™å®šæˆ‘ä»¬æ‰§è¡Œçš„è¾“å…¥/åŠ¨ä½œã€‚
*   æœ€åï¼Œæˆ‘ä»¬å°†**æ¯”è¾ƒ**è¿™æ®µä»£ç å®é™…åšäº†ä»€ä¹ˆå’Œæˆ‘ä»¬è¯´å®ƒåº”è¯¥åšä»€ä¹ˆã€‚

å¦‚æœå®ƒæŒ‰ç…§æˆ‘ä»¬è¯´çš„åšäº†ï¼Œæµ‹è¯•å°±é€šè¿‡äº†ã€‚å¦‚æœæ²¡æœ‰ï¼Œå®ƒå°±å¤±è´¥äº†ã€‚

### åŠŸèƒ½æµ‹è¯•ä¸éåŠŸèƒ½æµ‹è¯•

**åŠŸèƒ½**æµ‹è¯•æ˜¯æŒ‡æˆ‘ä»¬äº§å“çš„å®é™…**ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåšå®¢å¹³å°ï¼ŒåŠŸèƒ½æµ‹è¯•åº”è¯¥ç¡®ä¿ç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°çš„æ–‡ç« ï¼Œç¼–è¾‘è¿™äº›æ–‡ç« ï¼Œæµè§ˆå…¶ä»–äººå†™çš„æ–‡ç« ï¼Œç­‰ç­‰ã€‚**

**éåŠŸèƒ½æ€§**æµ‹è¯•æ˜¯æŒ‡ä»»ä½•ä¸æˆ‘ä»¬äº§å“çš„æ ¸å¿ƒç‰¹æ€§æ²¡æœ‰ä¸¥æ ¼å…³è”çš„**ã€‚è¿™åˆå¯ä»¥åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œä¾‹å¦‚:**

*   **å‹åŠ›æµ‹è¯•**æ£€æŸ¥åŸºç¡€è®¾æ–½å¦‚ä½•åº”å¯¹å¤§é‡ä½¿ç”¨ã€‚
*   **å®‰å…¨æµ‹è¯•**æ£€æŸ¥åº”ç”¨ç¨‹åºæ˜¯å¦å®¹æ˜“å—åˆ°å¸¸è§çš„é»‘å®¢æ”»å‡»ã€‚
*   **å¯è®¿é—®æ€§æµ‹è¯•**æ£€æŸ¥åº”ç”¨ç¨‹åºçš„ç¼–ç æ–¹å¼æ˜¯å¦é€‚åˆä¸åŒæ®‹éšœäººå£«ã€‚

### å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯•ä¸ç«¯åˆ°ç«¯æµ‹è¯•

å¯¹æµ‹è¯•è¿›è¡Œåˆ†ç±»çš„å¦ä¸€ç§æ–¹å¼æ˜¯æ ¹æ®å®ƒçš„å¹¿åº¦æˆ–ç»¼åˆæ€§ã€‚

**å•å…ƒæµ‹è¯•**æ—¨åœ¨ä»¥ç‹¬ç«‹çš„æ–¹å¼æµ‹è¯•å•ä¸ªåŠŸèƒ½ã€æ–¹æ³•æˆ–å°å—ä»£ç ã€‚åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œä»¥éš”ç¦»çš„æ–¹å¼æ£€æŸ¥å°æ®µä»£ç ã€‚

**é›†æˆæµ‹è¯•**æ£€æŸ¥å•ä¸ªä»£ç ç‰‡æ®µå¦‚ä½•ç›¸äº’ä½œç”¨å’ŒååŒå·¥ä½œã€‚åœ¨é›†æˆæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å°†å„ä¸ªéƒ¨åˆ†æ”¾åœ¨ä¸€èµ·ï¼Œçœ‹å®ƒä»¬æ˜¯å¦æ­£ç¡®äº¤äº’ã€‚

ç«¯åˆ°ç«¯æµ‹è¯•ï¼Œä¹Ÿç§°ä¸º E2Eï¼Œåœ¨æ¨¡æ‹Ÿå®é™…ç”¨æˆ·è¡Œä¸ºçš„æ¨¡æ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œç¨‹åºã€‚ä»¥ä¸€ä¸ªç½‘ç«™ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„ä»£ç å°†åœ¨ä¸€ä¸ªå®é™…çš„æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œæ‰€æœ‰çš„åŠŸèƒ½å°†ä»¥ç”¨æˆ·ä½¿ç”¨å®ƒä»¬çš„ç›¸åŒæ–¹å¼æ‰§è¡Œã€‚åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼ŒE2E æµ‹è¯•å¾ˆåƒæ‰‹å·¥æµ‹è¯•ï¼Œä½†æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–ã€‚

E2E æµ‹è¯•æ˜¯è¿™ä¸‰ç§æµ‹è¯•ä¸­æœ€å¹¿æ³›æˆ–æœ€å…¨é¢çš„ä¸€ç§ï¼Œå› ä¸ºå®ƒè¯„ä¼°æ•´ä¸ªç‰¹æ€§å’Œè¡Œä¸ºï¼Œè€Œä¸æ˜¯ä»£ç çš„ç‰¹å®šéƒ¨åˆ†ã€‚

### ç™½ç›’å¯¹æ¯”é»‘ç›’å¯¹æ¯”ç°ç›’æµ‹è¯•

æˆ‘ä»¬å°†çœ‹åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç±»å–å†³äºæˆ‘ä»¬çš„æµ‹è¯•å¯¹å®ç°ç»†èŠ‚æˆ–ç”¨æˆ·ä½“éªŒçš„å…³æ³¨ç¨‹åº¦ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼Œæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œå½“å®ƒè¢«ç‚¹å‡»æ—¶ï¼Œå®ƒæ‰“å¼€ä¸€ä¸ªæ¨¡æ€ã€‚åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼ŒæŒ‰é’®æœ‰ä¸€ä¸ªæ‰§è¡Œå‡½æ•°çš„ click äº‹ä»¶ä¾¦å¬å™¨ã€‚è¯¥å‡½æ•°æ›´æ”¹äº†æˆ‘ä»¬çš„æ¨¡æ€ HTML å…ƒç´ çš„ CSS ç±»ï¼Œå¹¶åœ¨å±å¹•ä¸Šå‘ˆç°äº†æ¨¡æ€ã€‚

æˆ‘ä»¬åœ¨æµ‹è¯•**å®ç°ç»†èŠ‚**æ—¶ï¼Œä¼šè°ˆåˆ°â€œ**ç™½ç›’**æµ‹è¯•ã€‚æŒ‰ç…§è¿™ä¸ªä¾‹å­ï¼Œåœ¨è¿™ä¸ªèŒƒä¾‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•æŒ‰é’®ç‚¹å‡»æ‰§è¡Œç›¸åº”çš„åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨åŠŸèƒ½æ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬çš„æ¨¡æ€å…ƒç´ çš„ CSS ç±»ç›¸åº”åœ°æ”¹å˜ã€‚

å¦ä¸€ç§æ–¹æ³•æ˜¯å®Œå…¨å¿˜è®°å®ç°ï¼Œåªæ£€æŸ¥å•å‡»æŒ‰é’®åæ˜¯å¦å‘ˆç°äº†æ¨¡æ€ã€‚æˆ‘ä»¬ä¸å…³å¿ƒ CSS ç±»æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸å…³å¿ƒç›¸åº”çš„å‡½æ•°æ˜¯å¦æ‰§è¡Œã€‚æˆ‘ä»¬åªæ˜¯ä¸“æ³¨äºæµ‹è¯•**ç”¨æˆ·åº”è¯¥æ„ŸçŸ¥ä»€ä¹ˆã€‚**é‚£æ˜¯â€œ**é»‘ç›’**æµ‹è¯•ã€‚

è€Œä¸”ï¼Œä½ å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œâ€œç°ç®±â€æµ‹è¯•åªæ˜¯å‰ä¸¤è€…çš„ç»“åˆã€‚

è¿™é‡Œè¦æåˆ°çš„æœ€åä¸€ä»¶äº‹æ˜¯ï¼Œè¿™äº›ä¸åŒç±»å‹çš„æµ‹è¯•ä¸ä¸€å®šæ˜¯äº’æ–¥çš„ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œå®ƒä»¬å¯ä»¥å¹¶ä¸”ç»å¸¸åœ¨ç›¸åŒçš„é¡¹ç›®ä¸­åŒæ—¶å®ç°ã€‚

æ‰‹åŠ¨æµ‹è¯•å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€åŠŸèƒ½æµ‹è¯•å’ŒéåŠŸèƒ½æµ‹è¯•ã€å•å…ƒæµ‹è¯•å’Œ E2E æµ‹è¯•éƒ½å¾ˆå¸¸è§...è¿™ä¸ªæƒ³æ³•æ€»æ˜¯è¯•å›¾åœ¨åˆç†çš„æ—¶é—´å’Œç²¾åŠ›å†…é¢„æµ‹å’Œè§£å†³å°½å¯èƒ½å¤šçš„é—®é¢˜ã€‚

# ä½•æ—¶æµ‹è¯•

ä¹ä¸€çœ‹ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œä½†å®é™…ä¸Šä¹Ÿæœ‰ä¸åŒçš„æ–¹æ³•ã€‚

æœ‰äº›äººå–œæ¬¢åœ¨ä»–ä»¬çš„åº”ç”¨ç¨‹åºå®Œå…¨å¼€å‘å‡ºæ¥åè¿›è¡Œæµ‹è¯•ã€‚å…¶ä»–äººå–œæ¬¢åœ¨ç¼–å†™åº”ç”¨ç¨‹åºçš„åŒæ—¶ç¼–å†™æµ‹è¯•ï¼Œå¹¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­æµ‹è¯•æ¯ä¸ªç‰¹æ€§ã€‚

å…¶ä»–äººå–œæ¬¢å…ˆå†™æµ‹è¯•ï¼Œç”¨è¿™ç§æ–¹å¼å®šä¹‰ç¨‹åºè¦å®Œæˆçš„æœ€ä½è¦æ±‚ã€‚ç„¶åä»–ä»¬ä»¥å°½å¯èƒ½å¿«åœ°é€šè¿‡æµ‹è¯•çš„æ–¹å¼ç¼–å†™åº”ç”¨ç¨‹åº(è¿™è¢«ç§°ä¸º[æµ‹è¯•é©±åŠ¨å¼€å‘æˆ– TDD](https://en.wikipedia.org/wiki/Test-driven_development) )ã€‚

ä¸€æ—¦ä½ å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–ä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½ï¼Œå¹¶ä¸”ä½ æœ‰äº†ä¸€ä¸ªæµ‹è¯•å¥—ä»¶(æµ‹è¯•å¥—ä»¶æ˜¯ä¸€ç»„æ£€æŸ¥ç‰¹å®šåŠŸèƒ½æˆ–æ•´ä¸ªåº”ç”¨ç¨‹åºçš„æµ‹è¯•)ï¼Œå¦ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯æ¯æ¬¡ä½ å¯¹ä»£ç åº“è¿›è¡Œä»»ä½•ç±»å‹çš„ä¿®æ”¹æ—¶è¿è¡Œä½ çš„æµ‹è¯•ï¼Œä»¥éªŒè¯æ²¡æœ‰ä»»ä½•ä¸œè¥¿è¢«ç ´åã€‚

æœ€åï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ª [CI/CD](https://en.wikipedia.org/wiki/CI/CD) ç³»ç»Ÿï¼Œé€šå¸¸ä¼šåœ¨ä»»ä½•éƒ¨ç½²ä¹‹å‰è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ã€‚å› æ­¤ï¼Œå¦‚æœä»»ä½•æµ‹è¯•å¤±è´¥ï¼Œéƒ¨ç½²å°±ä¼šåœæ­¢ï¼Œå¹¶å‘å‡ºæŸç§è­¦æŠ¥(è¿™å½“ç„¶æ€»æ¯”çœ‹åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºåœ¨ prod ä¸Šç€ç«è¦å¥½ğŸ”¥ğŸ˜±).

ä¸æµ‹è¯•ç±»å‹ä¸€æ ·ï¼Œåœ¨ä¸åŒçš„æ—¶é—´æµ‹è¯•åº”ç”¨ç¨‹åºæ˜¯å¾ˆå¸¸è§çš„ã€‚æ¯ä¸ªå…¬å¸é€šå¸¸éƒ½æœ‰è‡ªå·±çš„æµ‹è¯•æ—¶é—´è¡¨æˆ–å®è·µæ¥éµå¾ªï¼Œä»¥æ»¡è¶³ä»–ä»¬çš„éœ€æ±‚ã€‚

# æˆ‘ä»¬çš„å·¥å…·é›†

å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å¯¹ä»€ä¹ˆæ˜¯æµ‹è¯•ä»¥åŠæˆ‘ä»¬å¯ä»¥æ‰§è¡Œçš„æµ‹è¯•ç±»å‹æœ‰äº†ä¸€ä¸ªæ›´æ¸…æ™°çš„æ¦‚å¿µï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æˆ‘ä»¬å°†åœ¨ä¾‹å­ä¸­ä½¿ç”¨çš„å·¥å…·ã€‚

å¦‚å‰æ‰€è¿°ï¼Œæœ‰è®¸å¤šä¸åŒçš„åº“å¯ä¾›é€‰æ‹©æ¥è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚æˆ‘é€‰æ‹©è¿™å››ä¸ªæ˜¯å› ä¸ºå®ƒä»¬æ˜¯ JavaScript åº”ç”¨ä¸­æœ€å—æ¬¢è¿çš„ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è¿˜æœ‰æ›´å¤šé€‰æ‹©ã€‚æˆ‘å°†ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨çš„å¤§å¤šæ•°å·¥å…·å‘½åå¤‡é€‰æ–¹æ¡ˆï¼Œä»¥é˜²æ‚¨æƒ³è¦è¿›è¡Œæ›´å¤šè°ƒæŸ¥ã€‚ğŸ˜‰

## ä»€ä¹ˆæ˜¯ç©ç¬‘

Jest æ˜¯ä¸€ä¸ª JavaScript æµ‹è¯•è€…ã€‚æµ‹è¯•è¿è¡Œç¨‹åºæ˜¯ä¸€ä¸ªè½¯ä»¶ï¼Œå…è®¸ä½ è¿è¡Œæµ‹è¯•æ¥è¯„ä¼°ä½ çš„åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªç”± Meta(åŸè„¸ä¹¦)ç»´æŠ¤çš„å¼€æºé¡¹ç›®ï¼Œäº 2014 å¹´é¦–æ¬¡å¼€æºã€‚

æ—æ³¨:æ¯æ¬¡æˆ‘è¯´â€œæµ‹è¯•èµ›è·‘è€…â€ï¼Œæˆ‘éƒ½ä¼šæƒ³åˆ°è¿™ä¸ªã€‚åªæœ‰æˆ‘ä¸€ä¸ªäººå—ï¼ŸğŸ¤”

![8gTI-1](img/23b9e7758118072b66111c1861fbc98f.png)

Test runner, not Blade runner!

æ— è®ºå¦‚ä½•...åœ¨ä½¿ç”¨ [Babel](https://babeljs.io/) ã€ [TypeScript](https://www.typescriptlang.org/) ã€ [Node.js](https://nodejs.org/en/) ã€ [React](https://reactjs.org/) ã€ [Angular](https://angular.io/) ã€ [Vue.js](https://vuejs.org/) ã€[svelite](https://svelte.dev/)ç­‰æŠ€æœ¯çš„é¡¹ç›®ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ Jestã€‚ä½ å¯ä»¥åƒå®‰è£…ä»»ä½•åº“ä¸€æ ·é€šè¿‡ NPM å®‰è£… Jestï¼Œå®ƒåªéœ€è¦å¾ˆå°‘çš„é…ç½®å°±å¯ä»¥å¯åŠ¨ã€‚

ä½¿ç”¨ [create-react-app](https://create-react-app.dev/) è®¾ç½® React åº”ç”¨æ—¶ï¼ŒJest ä¼šé»˜è®¤å®‰è£…ã€‚

Jest é€šå¸¸ä¹Ÿè¢«ç§°ä¸ºæµ‹è¯•æ¡†æ¶ï¼Œå› ä¸ºé™¤äº†è¿è¡Œæµ‹è¯•ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰è®¸å¤šå…¶ä»–å†…ç½®ç‰¹æ€§(å¹¶éæ‰€æœ‰çš„æµ‹è¯•è¿è¡Œç¨‹åºéƒ½æ˜¯å¦‚æ­¤)ã€‚è¿™äº›åŠŸèƒ½åŒ…æ‹¬:

*   **æ–­è¨€åº“:** Jest é™„å¸¦äº†è®¸å¤šå†…ç½®çš„å‡½æ•°å’Œæ–¹æ³•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥æ–­è¨€æ‚¨çš„ä»£ç (æ–­è¨€åŸºæœ¬ä¸Šæ„å‘³ç€æ£€æŸ¥ä¸€æ®µä»£ç æ˜¯å¦åƒé¢„æœŸçš„é‚£æ ·è¿è¡Œ)ã€‚
*   Jest å…è®¸ä½ ä½¿ç”¨å¿«ç…§ï¼Œè¿™æ˜¯ä¸€ç§æ•æ‰å¤§å‹å¯¹è±¡å¹¶å°†å…¶å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ–¹å¼ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ä»¥åå°†å…¶ä¸å…¶ä»–å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚
*   Jest å…è®¸ä½ è·å¾—æµ‹è¯•çš„ä»£ç è¦†ç›–ç‡æŠ¥å‘Šã€‚è¿™äº›æŠ¥å‘Šæ˜¾ç¤ºäº†æ‚¨çš„ä»£ç ç›®å‰è¢«æµ‹è¯•çš„ç™¾åˆ†æ¯”ï¼Œæ‚¨ç”šè‡³å¯ä»¥çœ‹åˆ°ç›®å‰æ²¡æœ‰è¢«è¦†ç›–çš„ç¡®åˆ‡çš„ä»£ç è¡Œã€‚
*   Jest ä¹Ÿåƒä¸€ä¸ªæ¨¡ä»¿åº“ï¼Œå®ƒå…è®¸ä½ æ¨¡ä»¿æ•°æ®(åƒä¸€ä¸ªå‡½æ•°æˆ–æ¨¡å—)å¹¶åœ¨ä½ çš„æµ‹è¯•ä¸­ä½¿ç”¨å®ƒã€‚

Jest çš„ä¸€äº›ä¼—æ‰€å‘¨çŸ¥çš„æ›¿ä»£å“æ˜¯[æ‘©å¡](https://mochajs.org/)ã€[èŒ‰è‰](https://jasmine.github.io/)å’Œ[å› æœ](https://karma-runner.github.io/latest/index.html)ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„å°è§†é¢‘è§£é‡Šä»€ä¹ˆæ˜¯ç¬‘è¯ã€‚

## ä»€ä¹ˆæ˜¯æµ‹è¯•åº“ï¼Ÿ

Testing library ä¸æ˜¯ä¸€ä¸ªæµ‹è¯•è¿è¡Œç¨‹åºï¼Œè€Œæ˜¯ä¸€ç»„å°†ä¸ Jest æˆ– Mocha ä¹‹ç±»çš„æµ‹è¯•è¿è¡Œç¨‹åºä¸€èµ·å·¥ä½œçš„å®ç”¨ç¨‹åºã€‚è¿™ä¸ªå®ç”¨ç¨‹åºæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨æ¥è½»æ¾æµ‹è¯•ä»£ç çš„å·¥å…·ï¼Œå¹¶ä¸”æ›´æ³¨é‡ç”¨æˆ·ä½“éªŒ(é»‘ç›’æµ‹è¯•)ã€‚

Testing library æ˜¯ç”± [Kent C Dodds](https://kentcdodds.com/) å¼€å‘çš„(ä»–ä¹Ÿæ˜¯åœ°çƒä¸Šæœ€å¥½çš„ JS è€å¸ˆä¹‹ä¸€ï¼Œæ‰€ä»¥æˆ‘æ¨èä½ è·Ÿéšä»–)ã€‚

å¼•ç”¨[å®˜æ–¹æ–‡ä»¶:](https://testing-library.com/)

> â€œTesting Library ç³»åˆ—åº“æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„æµ‹è¯•è§£å†³æ–¹æ¡ˆï¼Œä¸éœ€è¦æ‰€æœ‰çš„å®ç°ç»†èŠ‚ã€‚
> 
> *å®ƒæä¾›çš„ä¸»è¦å®ç”¨ç¨‹åºåŒ…æ‹¬æŸ¥è¯¢èŠ‚ç‚¹ï¼Œç±»ä¼¼äºç”¨æˆ·å¦‚ä½•æ‰¾åˆ°å®ƒä»¬ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œtesting-library æœ‰åŠ©äºç¡®ä¿æ‚¨çš„æµ‹è¯•è®©æ‚¨å¯¹ UI ä»£ç å……æ»¡ä¿¡å¿ƒã€‚â€*

ç®€å•åœ°è¯´ï¼Œé€šè¿‡æµ‹è¯•åº“ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯• UI å…ƒç´ (æ¯”å¦‚ä¸€ä¸ªæ®µè½ã€ä¸€ä¸ªæŒ‰é’®ã€ä¸€ä¸ª div...)è€Œä¸æ˜¯æµ‹è¯•è´Ÿè´£å‘ˆç° UI çš„ä»£ç ã€‚

è¯¥åº“èƒŒåçš„åŸåˆ™æ˜¯:

> â€œä½ çš„æµ‹è¯•è¶Šåƒä½ çš„è½¯ä»¶è¢«ä½¿ç”¨çš„æ–¹å¼ï¼Œå®ƒä»¬å°±è¶Šèƒ½ç»™ä½ ä¿¡å¿ƒã€‚â€

...è¿™æ­£æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œé»‘ç›’â€æµ‹è¯•çš„å«ä¹‰ã€‚ğŸ˜‰

æµ‹è¯•åº“å®é™…ä¸Šæ˜¯ä¸€ç»„åº“,æ¯ä¸€ä¸ªåº“éƒ½æ˜¯ä¸ºäº†å®ç°ç›¸åŒçš„ç›®æ ‡è€Œåˆ›å»ºçš„ï¼Œä½†æ˜¯é€‚ç”¨äºä¸åŒçš„æŠ€æœ¯ï¼Œä¾‹å¦‚ Reactã€Angularã€Vueã€Svelteã€React Native ç­‰ç­‰...è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯èƒ½ä¼šå¬åˆ°â€œReact-testing-libraryâ€æˆ–è€…â€œVue-testing-libraryâ€ã€‚è¿™æ˜¯ä¸€æ ·çš„ä¸œè¥¿ï¼Œä½†é€‚ç”¨äºä¸åŒçš„æŠ€æœ¯ã€‚

ä½¿ç”¨ [create-react-app](https://create-react-app.dev/) è®¾ç½® React åº”ç”¨ç¨‹åºæ—¶ï¼Œé»˜è®¤å®‰è£… React-testing-libraryã€‚

æµ‹è¯•åº“çš„ä¸€ä¸ªæ›¿ä»£æ–¹æ³•æ˜¯[Enzyme](https://enzymejs.github.io/enzyme/)(Airbnb å¼€å‘çš„ä¸€å¥— UI æµ‹è¯•å·¥å…·)ã€‚

## æŸæ ‘æ˜¯ä»€ä¹ˆï¼Ÿ

Cypress æ˜¯ä¸€ä¸ªå¼€æºçš„æµ‹è¯•è¿è¡Œç¨‹åºï¼Œå®ƒå…è®¸ä½ åœ¨ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä½ çš„é¡¹ç›®ï¼Œå°±åƒç”¨æˆ·ä¸€æ ·ã€‚

æœ‰äº† Cypressï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æµè§ˆå™¨å°†è¦åšçš„äº‹æƒ…è¿›è¡Œç¼–ç¨‹(æ¯”å¦‚è®¿é—®ä¸€ä¸ª URLï¼Œç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œå®Œæˆå¹¶æäº¤ä¸€ä¸ªè¡¨å•...)å¹¶æ£€æŸ¥æ¯ä¸ªåŠ¨ä½œæ˜¯å¦ä¸ç›¸åº”çš„å“åº”ç›¸åŒ¹é…ã€‚

ä»¤äººé«˜å…´çš„æ˜¯ï¼Œæµ‹è¯•ä¸ç”¨æˆ·å°†ä½“éªŒåˆ°çš„éå¸¸ç›¸ä¼¼ã€‚ç”±äºåˆ¶ä½œè½¯ä»¶çš„å…¨éƒ¨ç›®çš„æ˜¯ç”¨æˆ·ï¼Œæˆ‘ä»¬è¶Šæ¥è¿‘ä»–ä»¬çš„è§†è§’ï¼Œæˆ‘ä»¬å°±è¶Šèƒ½æ•æ‰åˆ°ä»£ç ä¸­æœ€æœ‰æ„ä¹‰çš„é”™è¯¯ã€‚(æ­¤å¤–ï¼Œçœ‹åˆ°è‡ªåŠ¨åŒ–æµè§ˆå™¨åœ¨å‡ ç§’é’Ÿå†…æµè§ˆæ•´ä¸ªåº”ç”¨ç¨‹åºçœŸçš„å¾ˆé…·...ğŸ¤“)

Cypress çš„å¦ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹ç‚¹æ˜¯â€œæ—¶é—´æ—…è¡Œâ€ã€‚åœ¨ Cypress çš„è‡ªåŠ¨åŒ–æµè§ˆå™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç¼–å†™çš„æ‰€æœ‰æµ‹è¯•ï¼Œåªéœ€å°†é¼ æ ‡æ‚¬åœåœ¨ä¸Šé¢å°±å¯ä»¥çœ‹åˆ°å…¶ç»“æœçš„å›¾å½¢å¿«ç…§ã€‚è¿™æ˜¯ä¸€ä»¶éå¸¸æœ‰ç”¨çš„äº‹æƒ…ï¼Œæœ‰åŠ©äºæ›´å¥½åœ°äº†è§£ä»€ä¹ˆåœ¨å‘ç”Ÿï¼Œä»€ä¹ˆæ—¶å€™å‘ç”Ÿã€‚

å°½ç®¡å®ƒå¯ä»¥ç”¨äºå•å…ƒå’Œé›†æˆæµ‹è¯•ï¼Œä½† Cypress ä¸»è¦ç”¨äºç«¯åˆ°ç«¯æµ‹è¯•ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨å‡ ç§’é’Ÿå†…è½»æ¾è¯„ä¼°å®Œæ•´çš„ç‰¹æ€§ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ Cypress æ¥æµ‹è¯•åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ä»»ä½•ä¸œè¥¿ï¼Œå› æ­¤æ‚¨å¯ä»¥è½»æ¾åœ°åœ¨ Reactã€Angularã€Vue ç­‰ä¸Šå®ç°å®ƒã€‚

ä¸ Jest å’Œ React-Testing-Library ä¸åŒï¼ŒCypress æ²¡æœ‰é¢„è£… create-react-appã€‚ä½†æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å®‰è£…å®ƒä¸ NPM æˆ–æ‚¨çš„è½¯ä»¶åŒ…ç®¡ç†å™¨çš„é€‰æ‹©ã€‚

ä¸€äº›æŸæ ‘çš„æ›¿ä»£å“æ˜¯ç¡’å’Œ T2 æœ¨å¶å¸ˆã€‚

Fireship æä¾›äº†ä¸€æ®µç”œèœœçš„è§†é¢‘ï¼Œè§£é‡Šäº†æŸæ ‘æ˜¯ä»€ä¹ˆä»¥åŠå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

æ—æ³¨:...æ¯æ¬¡æˆ‘è°ˆåˆ°æŸæ ‘æ—¶ï¼Œå®ƒå°±ä¼šåœ¨æˆ‘è„‘æµ·ä¸­æµ®ç°ã€‚ğŸ˜

## ä»€ä¹ˆæ˜¯è¶…çº§æµ‹è¯•ï¼Ÿ

[Supertest](https://github.com/visionmedia/supertest) æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿ HTTP è¯·æ±‚çš„åº“ã€‚ç”¨ Jest æµ‹è¯•åç«¯èŠ‚ç‚¹åº”ç”¨ç¨‹åºéå¸¸æ–¹ä¾¿(æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­çœ‹åˆ°)ã€‚

### å·¥å…·ç»¼è¿°

ä½œä¸ºè¿™ä¸ªè¯é¢˜çš„å¿«é€Ÿæ€»ç»“:

*   Jest æ˜¯æˆ‘ä»¬ç”¨æ¥ç¼–å†™å’Œè¿è¡Œ JavaScript æµ‹è¯•çš„åº“ã€‚
*   æµ‹è¯•åº“å’Œ Jest ä¸€èµ·å·¥ä½œï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ç›´æ¥æµ‹è¯• UI çš„å‡½æ•°å’Œæ–¹æ³•ï¼Œå¿˜è®°äº†èƒŒåçš„ä»£ç ã€‚
*   Cypress åœ¨æ¨¡æ‹Ÿæµè§ˆå™¨ä¸­è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶æ£€æŸ¥ UI ä¸­æ‰§è¡Œçš„æ“ä½œæ˜¯å¦å¦‚é¢„æœŸé‚£æ ·å“åº”ã€‚
*   Supertest æ˜¯ä¸€ä¸ªæ¨¡ä»¿ HTTP è¯·æ±‚çš„åº“ï¼Œå®ƒå¯ä»¥å’Œ Jest ä¸€èµ·ç”¨æ¥æµ‹è¯•åç«¯åº”ç”¨ç¨‹åºã€‚

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æœ‰è¶£çš„éƒ¨åˆ†...

![giphy-2](img/8cff0c502761125559880f05790dae39.png)

Let the testing begin!!

# å¦‚ä½•æµ‹è¯•æ™®é€šçš„ JS ä»£ç 

å¥½äº†ï¼Œè®©æˆ‘ä»¬ä»æµ‹è¯•ä¸€äº›ç®€å•çš„æ™®é€š JS ä»£ç å¼€å§‹ã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­å®ç° Jestï¼Œå¹¶å­¦ä¹ å®ƒå¦‚ä½•å·¥ä½œçš„åŸºæœ¬çŸ¥è¯†ã€‚

è®©æˆ‘ä»¬é¦–å…ˆåœ¨æˆ‘ä»¬çš„æœºå™¨ä¸­åˆ›å»ºæ–°ç›®å½•ï¼Œå¹¶ç”¨`npm init -y`åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ appã€‚ç„¶åé€šè¿‡è¿è¡Œ`npm i -D jest`å®‰è£… Jest(`-D`å°†å…¶ä¿å­˜ä¸ºå¼€å‘ä¾èµ–)ã€‚

ç°åœ¨æ‚¨åº”è¯¥åœ¨æ‚¨çš„`package.json`æ–‡ä»¶ä¸­çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:`"devDependencies": { "jest": "^27.5.1" }` ã€‚

è¯´åˆ°è¿™é‡Œï¼Œåœ¨ä½ çš„`package.json`ä¸­ï¼ŒæŠŠä½ çš„`test`å‰§æœ¬æ¢æˆ`"test": "jest"`ã€‚è¿™å°†å…è®¸æˆ‘ä»¬ç¨åé€šè¿‡è¿è¡Œ`npm test`æ¥è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚ï¼›)

æ‚¨çš„æ•´ä¸ª`package.json`æ–‡ä»¶åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

```
{
  "name": "vanillatesting",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "jest"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "jest": "^27.5.1"
  }
} 
```

é…·ï¼Œæˆ‘ä»¬éƒ½å‡†å¤‡å¥½å†™ä¸€äº›å¯ä»¥æµ‹è¯•çš„ JS äº†ï¼åˆ›å»ºä¸€ä¸ª`index.js`æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹ä»£ç æ”¾å…¥å…¶ä¸­:

```
// index.js
function isPalindrome(string) {
    // O(n)
    // Put a pointer at each extreme of the word and iterate "inwards"
    // At each iteration, check if the pointers represent equal values
    // If this condition isn't accomplished, the word isn't a palindrome
    let left = 0
    let right = string.length-1

    while (left < right) {
        if (string[left] === string[right]) {
            left += 1
            right -= 1
        }
        else return false
    }

    return true
} 
```

è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ª[å›æ–‡](https://en.wikipedia.org/wiki/Palindrome)æ£€æŸ¥å™¨ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²æ˜¯å›æ–‡ï¼Œåˆ™è¿”å›`true`,å¦åˆ™è¿”å›`false`ã€‚(è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„æŠ€æœ¯é¢è¯•é—®é¢˜ï¼Œä½†é‚£æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„å†…å®¹ã€‚ğŸ¤«)

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨å¯¼å‡ºå‡½æ•°ã€‚è¡¥å……è¯´æ˜:å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº JS æ¨¡å—çš„å·¥ä½œåŸç†ï¼Œæˆ‘æœ€è¿‘å†™äº†ä¸€ç¯‡æ–‡ç« ã€‚

å¤ªå¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦å¦‚é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º`index.test.js`çš„æ–‡ä»¶ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯æˆ‘ä»¬ç¼–å†™æµ‹è¯•çš„åœ°æ–¹ã€‚æˆ‘ä»¬ä½¿ç”¨çš„åç¼€(`.test.js`)åœ¨è¿™é‡Œå¾ˆé‡è¦ï¼Œå› ä¸º Jest ä¼šè‡ªåŠ¨è¯†åˆ«`.test`æ–‡ä»¶ï¼Œå¹¶åœ¨æˆ‘ä»¬å‘½ä»¤ Jest æµ‹è¯•æˆ‘ä»¬çš„é¡¹ç›®æ—¶æ‰§è¡Œå®ƒä»¬ã€‚

Jest è¿˜è¯†åˆ«å¸¦æœ‰`.spec`åç¼€çš„æ–‡ä»¶ï¼Œæ¯”å¦‚`index.spec.js`(å¯¹äºâ€œè§„èŒƒâ€ï¼ŒæŒ‡çš„æ˜¯ä½ çš„é¡¹ç›®çš„éœ€æ±‚)ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ›´å–œæ¬¢`.test`ï¼Œå› ä¸ºå®ƒå¯¹æˆ‘æ¥è¯´æ„Ÿè§‰æ›´æ¸…æ™°ï¼Œä½†ä¸¤è€…éƒ½ä¸€æ ·ã€‚

ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæµ‹è¯•ï¼æŠŠè¿™ä¸ªæ”¾åœ¨ä½ çš„`index.test.js`æ–‡ä»¶é‡Œã€‚

```
// index.test.js
isPalindrome = require('./index.js')

test('neuquen is palindrom', () => {
    expect(isPalindrome("neuquen")).toBe(true)
})

test('bariloche is not palindrom', () => {
    expect(isPalindrome("bariloche")).toBe(false)
}) 
```

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æˆ‘ä»¬å®é™…æ­£åœ¨åšçš„äº‹æƒ…:

1.  éœ€è¦æˆ‘ä»¬è¦æµ‹è¯•çš„å‡½æ•°:`isPalindrome = require('./index.js')`
2.  Jest æä¾›äº†`test()`å‡½æ•°ï¼Œæˆ‘ä»¬å°†åœ¨å…¶ä¸­æ”¾ç½®æˆ‘ä»¬å¸Œæœ› Jest æ‰§è¡Œçš„ä»£ç ã€‚
3.  `test()`éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯æµ‹è¯•æè¿°ï¼Œè¿™æ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„åç§°ï¼Œå½“æµ‹è¯•è¿è¡Œæ—¶ï¼Œå®ƒå°†æ˜¾ç¤ºåœ¨æˆ‘ä»¬çš„æ§åˆ¶å°ä¸Šã€‚æˆ‘ä»¬é©¬ä¸Šä¼šçœ‹åˆ°ä¸€ä¸ªä¾‹å­ã€‚
4.  ç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒï¼Œå®ƒåŒ…å«å®é™…çš„æµ‹è¯•ä»£ç ã€‚
5.  åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº†`expect()`å‡½æ•°(ä¹Ÿç”± Jest æä¾›)ã€‚`expect()`å°†æˆ‘ä»¬çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå®ƒæœ¬èº«æ­£åœ¨æ¥æ”¶ä¸€ä¸ªæˆ‘ä»¬ç¼–é€ çš„å‚æ•°ã€‚
6.  æœ€åï¼Œæˆ‘ä»¬é“¾æ¥`.toBe()`å‡½æ•°(ä¹Ÿç”± Jest æä¾›),å¹¶ä½œä¸ºå‚æ•°ä¼ é€’æˆ‘ä»¬æœŸæœ›`isPalindrome()`åœ¨æ¯ç§æƒ…å†µä¸‹è¿”å›çš„å€¼ã€‚(â€œneuquenâ€æ˜¯ä¸€ä¸ªå›æ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‡½æ•°åº”è¯¥è¿”å›`true`ï¼Œè€Œâ€œbarilocheâ€ä¸æ˜¯ï¼Œæ‰€ä»¥å®ƒåº”è¯¥è¿”å›`false`ã€‚)

æˆ‘æœ€å–œæ¬¢ Jest çš„ä¸€ç‚¹æ˜¯å®ƒçš„è®¾ç½®éå¸¸ç®€å•ã€‚æˆ‘éå¸¸å–œæ¬¢çš„å¦ä¸€ä»¶äº‹æ˜¯å®ƒçš„è¯­æ³•æ˜¯å¦‚ä½•è‡ªæˆ‘è§£é‡Šçš„ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡é˜…è¯»æ¥ç†è§£æˆ‘ä»¬çš„æµ‹è¯•å°†è¯„ä¼°ä»€ä¹ˆã€‚ğŸ‘Œ

ç°åœ¨è®©æˆ‘ä»¬è¯•è¯•è¿™ä¸ªï¼å¦‚æœæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­è¿è¡Œ`npm test`,æˆ‘ä»¬åº”è¯¥å¾—åˆ°ä»¥ä¸‹ç»“æœ:

```
// console
> jest PASS 
./index.test.js
âœ“ neuquen is palindrom (1 ms)
âœ“ bariloche is not palindrom

Test Suites: 1 passed, 1
total Tests:       2 passed, 2
total Snapshots:   0
total Time:        0.244 s
Ran all test suites. 
```

æ­å–œä½ ï¼Œä½ åˆšåˆšé€šè¿‡äº†ä½ çš„ç¬¬ä¸€ä¸ªç¬‘è¯æµ‹è¯•ã€‚

![mr-miyagi-nod-1](img/b81bcf7ef0710735b98f272eaaa60197.png)![lets-get-this-party-started-yeah-1](img/f77f0d274d19801b050981cc7f9ba0ea.png)

ä¸ºäº†çœ‹çœ‹å¤±è´¥çš„æµ‹è¯•æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè®©æˆ‘ä»¬é€šè¿‡ç¼–è¾‘`return`è¡Œæ¥æ”¹å˜æˆ‘ä»¬çš„å‡½æ•°ã€‚

```
// index.js
function isPalindrome(string) {
    // O(n)
    // Put a pointr at each extreme of the word and iterate "inwards"
    // At each iteration, check if the pointers represent equal values
    // If this condition isn't accomplished, the word isn't a palindrome
    let left = 0
    let right = string.length-1

    while (left < right) {
        if (string[left] === string[right]) {
            left += 1
            right -= 1
        }
        else return 1
    }

    return 2
} 
```

ç°åœ¨æ‚¨åº”è¯¥å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æœ:

```
// console
> vanillatesting@1.0.0 test
> jest

 FAIL  ./index.test.js
  âœ• neuquen is palindrom (4 ms)
  âœ• bariloche is not palindrom

  â— neuquen is palindrom

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: 2

      3 | // describe('isPalindrome function', () => {
      4 |   test('neuquen is palindrom', () => {
    > 5 |     expect(isPalindrome("neuquen")).toBe(true)
        |                                     ^
      6 |   })
      7 |
      8 |   test('bariloche is not palindrom', () => {

      at Object.<anonymous> (index.test.js:5:37)

  â— bariloche is not palindrom

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: 1

       7 |
       8 |   test('bariloche is not palindrom', () => {
    >  9 |     expect(isPalindrome("bariloche")).toBe(false)
         |                                       ^
      10 |   })
      11 | // })
      12 |

      at Object.<anonymous> (index.test.js:9:39)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 2 total
Snapshots:   0 total
Time:        0.28 s, estimated 1 s
Ran all test suites. 
```

è¯·æ³¨æ„ï¼Œæ‚¨ä¼šå¾—åˆ°ä¸€ä¸ªå…³äºå“ªäº›æµ‹è¯•å¤±è´¥äº†ä»¥åŠåœ¨ä»€ä¹ˆåœ°æ–¹å¤±è´¥äº†çš„è¯¦ç»†æè¿°ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå½“æˆ‘ä»¬æ–­è¨€(æ£€æŸ¥)è¿”å›å€¼æ—¶ï¼Œå®ƒä»¬å¤±è´¥äº†ã€‚

è¿™éå¸¸æœ‰ç”¨ï¼Œæˆ‘ä»¬åº”è¯¥å§‹ç»ˆå…³æ³¨è¿™äº›æè¿°ï¼Œå› ä¸ºæœ‰æ—¶æˆ‘ä»¬çš„æµ‹è¯•å¯èƒ½ä¼šå› ä¸ºæ²¡æœ‰æ­£ç¡®ç¼–å†™è€Œå¤±è´¥ã€‚æˆ‘ä»¬é€šå¸¸ä¹Ÿä¸ä¼šä¸ºæˆ‘ä»¬çš„æµ‹è¯•ç¼–å†™æµ‹è¯•...ğŸ˜…æ‰€ä»¥å½“ä½ çœ‹åˆ°ä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å®ƒæ˜¯å¦å¦‚é¢„æœŸçš„é‚£æ ·å·¥ä½œï¼Œç„¶åå†å»æ£€æŸ¥ä½ çš„å®é™…ä»£ç ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ å¹¶æµ‹è¯•å¦ä¸€ä¸ªå‡½æ•°æ¥å±•ç¤ºæ›´å¤š Jest ç‰¹æ€§:

```
// index.js
function twoSum(nums, target) {
    // O(n)
    // Iterate the array once
    // At each iteration, calculate the value needed to get to the target, which is target - currentValue
    // If the neededValue exists in the array, return [currentValue, neededValue], else continue iteration
	for (let i = 0; i < nums.length; i++) {
		const neededNum = target - nums[i]
		if (nums.indexOf(neededNum) !== -1 && nums.indexOf(neededNum) !== i) return [nums[i], nums[nums.indexOf(neededNum)]]
	}
    return false
}

module.exports = { isPalindrome, twoSum } 
```

è¿™åˆæ˜¯ä¸€ä¸ªç»å…¸çš„é¢è¯•é—®é¢˜ã€‚è¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ•°å­—æ•°ç»„å’Œä¸€ä¸ªç›®æ ‡æ•°å€¼ã€‚å®ƒçš„ä½œç”¨æ˜¯è¯†åˆ«æ•°ç»„ä¸­æ˜¯å¦æœ‰ä¸¤ä¸ªæ•°å­—åŠ èµ·æ¥ç­‰äºç¬¬äºŒä¸ªå‚æ•°å€¼ã€‚å¦‚æœè¿™ä¸¤ä¸ªå€¼å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œå®ƒå°†åœ¨æ•°ç»„ä¸­è¿”å›å®ƒä»¬ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå®ƒå°†è¿”å› falseã€‚

ç°åœ¨è®©æˆ‘ä»¬ä¸ºæ­¤ç¼–å†™ä¸€äº›æµ‹è¯•:

```
({ isPalindrome, twoSum } = require('./index.js'))

...

test('[2,7,11,15] and 9 returns [2, 7]', () => {
    expect(twoSum([2,7,11,15], 9)).toEqual([2,7])
})

test('[3,2,4] and 6 returns [2, 4]', () => {
    expect(twoSum([3,2,4], 6)).toEqual([2,4])
})

test('[3,2,4] and 10 returns false', () => {
    expect(twoSum([3,2,4], 10)).toBe(false)
}) 
```

çœ‹åˆ°ç»“æ„å‡ ä¹ç›¸åŒï¼Œé™¤äº†æˆ‘ä»¬åœ¨ä¸¤ä¸ªæµ‹è¯•ä¸­ä½¿ç”¨äº†ä¸åŒçš„**åŒ¹é…å™¨**ï¼Œ`toEqual()`ã€‚

**Matchers** æ˜¯ Jests ä¸ºæˆ‘ä»¬æä¾›çš„è¯„ä¼°å€¼çš„å‡½æ•°ã€‚æœ‰è®¸å¤šç±»å‹çš„åŒ¹é…å™¨å¯ä»¥ç”¨äºè®¸å¤šä¸åŒçš„åœºåˆã€‚

ä¾‹å¦‚ï¼Œ`.toBe()`ç”¨äºè®¡ç®—å­—ç¬¦ä¸²ã€æ•°å­—æˆ–å¸ƒå°”å€¼ç­‰åŸè¯­ã€‚`toEqual()`ç”¨äºè¯„ä¼°å¯¹è±¡(å‡ ä¹æ¶µç›–äº† Javascript ä¸­çš„æ‰€æœ‰å†…å®¹)ã€‚

å¦‚æœä½ éœ€è¦æ¯”è¾ƒè¿”å›å€¼å’Œä¸€ä¸ªæ•°å­—ï¼Œä½ å¯ä»¥ä½¿ç”¨`.toBeGreaterThan()`æˆ–è€…`toBeGreaterThanOrEqual()`ç­‰ç­‰...

è¦æŸ¥çœ‹å¯ç”¨åŒ¹é…å™¨çš„å®Œæ•´åˆ—è¡¨ï¼Œ[æŸ¥çœ‹æ–‡æ¡£](https://jestjs.io/docs/using-matchers)ã€‚

å¦‚æœæˆ‘ä»¬ç°åœ¨è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä»¥ä¸‹ç»“æœ:

```
> vanillatesting@1.0.0 test
> jest

 PASS  ./index.test.js
  âœ“ neuquen is palindrom (2 ms)
  âœ“ bariloche is not palindrom
  âœ“ [2,7,11,15] and 9 returns [2, 7] (1 ms)
  âœ“ [3,2,4] and 6 returns [2, 4]
  âœ“ [3,2,4] and 10 returns false (1 ms)

Test Suites: 1 passed, 1 total
Tests:       5 passed, 5 total
Snapshots:   0 total
Time:        0.256 s, estimated 1 s
Ran all test suites. 
```

è¿™å¾ˆé…·ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æµ‹è¯•ç»“æœçœ‹èµ·æ¥æœ‰ç‚¹ä¹±ã€‚éšç€æˆ‘ä»¬æµ‹è¯•å¥—ä»¶çš„å¢é•¿ï¼Œè¯†åˆ«æ¯ä¸ªå•ç‹¬çš„ç»“æœå¯èƒ½ä¼šæ›´åŠ å›°éš¾ã€‚

ä¸ºäº†å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ï¼ŒJest ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª`describe()`å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒå°†æµ‹è¯•åˆ†ç»„åœ¨ä¸€èµ·ï¼Œå¹¶ä»¥ä¸€ç§æ›´ç¤ºæ„æ€§çš„æ–¹å¼æ˜¾ç¤ºç»“æœã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒ:

```
({ isPalindrome, twoSum } = require('./index.js'))

describe('isPalindrome function', () => {
  test('neuquen is palindrom', () => {
    expect(isPalindrome("neuquen")).toBe(true)
  })

  test('bariloche is not palindrom', () => {
    expect(isPalindrome("bariloche")).toBe(false)
  })
})

describe('twoSum function', () => {
  test('[2,7,11,15] and 9 returns [2, 7]', () => {
    expect(twoSum([2,7,11,15], 9)).toEqual([2,7])
  })

  test('[3,2,4] and 6 returns [2, 4]', () => {
    expect(twoSum([3,2,4], 6)).toEqual([2,4])
  })

  test('[3,2,4] and 10 returns false', () => {
    expect(twoSum([3,2,4], 10)).toBe(false)
  })
}) 
```

ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æƒ³è¦ä¸ºç»™å®šçš„æµ‹è¯•ç»„æ˜¾ç¤ºçš„æè¿°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åŒ…å«æˆ‘ä»¬çš„æµ‹è¯•çš„å›è°ƒã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬å†æ¬¡è¿è¡Œ`npm test`ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™ä¸ªğŸ˜ï¼š

```
// console
> vanillatesting@1.0.0 test
> jest

 PASS  ./index.test.js
  isPalindrome function
    âœ“ neuquen is palindrom (2 ms)
    âœ“ bariloche is not palindrom
  twoSum function
    âœ“ [2,7,11,15] and 9 returns [2, 7] (1 ms)
    âœ“ [3,2,4] and 6 returns [2, 4]
    âœ“ [3,2,4] and 10 returns false

Test Suites: 1 passed, 1 total
Tests:       5 passed, 5 total
Snapshots:   0 total
Time:        0.216 s, estimated 1 s
Ran all test suites. 
```

# å¦‚ä½•ä½¿ç”¨ Jest å’Œ React æµ‹è¯•åº“æµ‹è¯•å‰ç«¯ React åº”ç”¨ç¨‹åº

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº† Jest çš„åŸºæœ¬çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å°†å®ƒä¸æµ‹è¯•åº“ç»“åˆèµ·æ¥æµ‹è¯• React åº”ç”¨ç¨‹åºã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚åªæ˜¯ä¸€ä¸ªéšæœºæ–‡æœ¬çš„é¡µé¢ï¼Œä¸€ä¸ªåˆ‡æ¢å¦ä¸€æ®µæ–‡æœ¬çš„æŒ‰é’®ï¼Œä¸€ä¸ªæ–‡æœ¬è¾“å…¥ï¼Œå’Œä¸€ä¸ªåˆ‡æ¢è¾“å…¥å‘ˆç°çš„æŒ‰é’®ã€‚

![Recording-2022-04-23-at-21.11.24](img/83e1509452d85cf3a833a71905b95d60.png)

è€ƒè™‘åˆ°æˆ‘ä»¬å°†ä½¿ç”¨ [create-react-app](https://create-react-app.dev/) æ¥åˆ›å»ºè¿™ä¸ªåº”ç”¨ç¨‹åº(å®ƒé»˜è®¤å®‰è£…äº† Jest å’Œæµ‹è¯•åº“)ã€‚å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨ create-react-appï¼Œæ‚¨å¯èƒ½éœ€è¦å®‰è£…è¿™ä¸¤ä¸ªåº“å¹¶æ·»åŠ ä¸€äº›é¢å¤–çš„é…ç½®ã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œä¸ä¼šçœ‹åˆ°ä»»ä½• React ä»£ç ï¼Œæˆ‘ä»¬åªå…³æ³¨æµ‹è¯•ã€‚

æˆ‘ä»¬é¡¹ç›®çš„æ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹:

```
> src
    > components
        - About.jsx
    - App.jsx
    - Index.js
    - setupTests.js 
```

è¿™é‡Œçš„`setupTests.js`æ–‡ä»¶å¾ˆé‡è¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä½¿ç”¨ create-react-app åˆ›å»ºçš„ï¼Œå†…å®¹å¦‚ä¸‹:

```
// jest-dom adds custom jest matchers for asserting on DOM nodes.
// allows you to do things like:
// expect(element).toHaveTextContent(/react/i)
// learn more: https://github.com/testing-library/jest-dom
import '@testing-library/jest-dom'; 
```

å®ƒå…¨å±€å¯¼å…¥ Testing library æä¾›çš„`jest-dom`åº“ï¼Œè¿™ç»™äº†æˆ‘ä»¬é¢å¤–çš„ Jest matchersï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æµ‹è¯• DOM(æ¯”å¦‚`toHaveTextContent(), toBeInTheDocument()`ç­‰)ã€‚

æˆ‘ä»¬ä¸€ä¼šå„¿ä¼šçœ‹åˆ°ä¸€äº›ä¾‹å­ï¼Œä½†æ˜¯è¦çŸ¥é“æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ä¸€äº›å‡½æ•°å’ŒåŒ¹é…å™¨æ¥è‡ªè¿™é‡Œã€‚

å…³äºæˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ä¸ºæˆ‘ä»¬æµ‹è¯•çš„æ¯ä¸ªç»„ä»¶å‡†å¤‡ä¸€ä¸ªä¸åŒçš„æµ‹è¯•æ–‡ä»¶ã€‚

å…³äºå°†å®ƒä»¬æ”¾åœ¨å“ªé‡Œï¼Œä¸¤ç§å¸¸è§çš„åšæ³•æ˜¯å°†å®ƒä»¬éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ¯”å¦‚`__tests__`æˆ–ç±»ä¼¼çš„æ–‡ä»¶å¤¹ï¼Œæˆ–è€…å°†æ¯ä¸ªæµ‹è¯•æ–‡ä»¶æ”¾åœ¨ä¸è¢«æµ‹è¯•ç»„ä»¶ç›¸åŒçš„æ–‡ä»¶å¤¹ä¸­ã€‚

æˆ‘æ›´å–œæ¬¢åè€…ï¼Œå› ä¸ºæˆ‘ç»å¸¸ä¼šä»ç»„ä»¶ä»£ç è·³åˆ°æµ‹è¯•ä»£ç ï¼Œè€Œä¸”æœ‰ä»–ä»¬åœ¨èº«è¾¹ä¹Ÿä¸é”™ã€‚ä½†æ˜¯çœŸçš„æ²¡å…³ç³»ã€‚åªè¦æˆ‘ä»¬ä½¿ç”¨`.test`æˆ–`.spec`åç¼€ï¼ŒJest å°±ä¼šè¯†åˆ«å¹¶è¿è¡Œè¿™äº›æ–‡ä»¶ã€‚

åˆ›å»ºäº†æµ‹è¯•æ–‡ä»¶åï¼Œæˆ‘ä»¬çš„æ–‡ä»¶å¤¹ç»“æ„åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

```
> src
    > components
        - About.jsx
        - About.test.jsx
    - App.jsx
    - Index.js
    - setupTests.js 
```

é…·ï¼è®©æˆ‘ä»¬ä»æµ‹è¯•æˆ‘ä»¬çš„`About`ç»„ä»¶å¼€å§‹ã€‚

é¦–å…ˆè®©æˆ‘ä»¬æµ‹è¯•å®ƒçš„æ¸²æŸ“æ˜¯å¦æ­£ç¡®ï¼Œå°±åƒè¿™æ ·:

```
// About.test.jsx
import { render, screen } from '@testing-library/react'
import About from './About'

describe('About', () => {

  test('About renders correctly', () => {
    render( <About/> )
    expect(screen.getByText("I'm the about page!")).toBeInTheDocument()
  })

}) 
```

*   çœ‹åˆ°æˆ‘ä»¬å¼€å§‹ä»æµ‹è¯•åº“å¯¼å…¥ä¸¤ä¸ªä¸œè¥¿:`import { render, screen } from '@testing-library/react'`ã€‚

`render`å‡½æ•°å°†ä¸€ä¸ª React ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå®ƒå°†å‘ˆç°å®ƒï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æµ‹è¯•å®ƒã€‚

`screen`æ˜¯ä¸€ä¸ªå¸¦æœ‰å¤§é‡æŸ¥è¯¢çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ç›´æ¥æµ‹è¯• UIï¼Œè·³è¿‡å®ç°ç»†èŠ‚ï¼Œä¸“æ³¨äºç”¨æˆ·å®é™…çœ‹åˆ°çš„å†…å®¹ã€‚

*   ç„¶åæˆ‘ä»¬å¯¼å…¥æˆ‘ä»¬çš„`About`ç»„ä»¶:`import About from './About'`
*   æˆ‘ä»¬ä½¿ç”¨å‰é¢æåˆ°çš„`describe`å’Œ`test` Jest å‡½æ•°ã€‚
*   æˆ‘ä»¬æ¸²æŸ“`About`ç»„ä»¶:`render( <About/> )`
*   æˆ‘ä»¬ä½¿ç”¨`expect` Jest å‡½æ•°ï¼Œä½œä¸ºå‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•åº“æä¾›çš„`screen`å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨å®ƒçš„`getByText`æŸ¥è¯¢ï¼Œè¯¥æŸ¥è¯¢æ‰«æ React ç»„ä»¶ï¼ŒæŸ¥æ‰¾æˆ‘ä»¬ä½œä¸ºå‚æ•°ä¼ é€’çš„æ–‡æœ¬ã€‚
*   æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•åº“çš„`.toBeInTheDocument()`åŒ¹é…å™¨ï¼Œå®ƒåªæ˜¯æ£€æŸ¥å…ˆå‰çš„æŸ¥è¯¢ç»“æœæ˜¯å¦è¢«å‘ˆç°ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•â€œåˆ‡æ¢çŠ¶æ€â€åˆ‡æ¢æŒ‰é’®æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
// About.test.jsx
import { render, screen } from '@testing-library/react'
import userEvent from '@testing-library/user-event'
import About from './About'

describe('About', () => {

  ...

  test('Switch state works correctly', async () => {
    render( <About/> )

    expect(screen.getByText("It's on!")).toBeInTheDocument()
    userEvent.click(screen.getByText('Switch state'))
    expect(screen.getByText("It's rolling!")).toBeInTheDocument()
    userEvent.click(screen.getByText('Switch state'))
    expect(screen.getByText("It's on!")).toBeInTheDocument()
  })

}) 
```

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯¼å…¥äº†ä¸€ä¸ªåä¸º`userEvent`çš„é™„åŠ å®ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªåŒ…å«è®¸å¤šæ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ¨¡æ‹Ÿç”¨æˆ·è§¦å‘çš„äº‹ä»¶ï¼Œæ¯”å¦‚ç‚¹å‡»ã€æ‚¬åœã€è¾“å…¥ç­‰ç­‰ã€‚

*   æˆ‘ä»¬é¦–å…ˆæ£€æŸ¥é»˜è®¤å­—ç¬¦ä¸²æ˜¯å¦è¢«å‘ˆç°:`expect(screen.getByText("It's on!")).toBeInTheDocument()`
*   ç„¶åï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€æ¬¡ç‚¹å‡»ï¼Œå¹¶æ£€æŸ¥å±å¹•ä¸­çš„å­—ç¬¦ä¸²æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–:

```
userEvent.click(screen.getByText('Switch state'))
expect(screen.getByText("It's rolling!")).toBeInTheDocument() 
```

*   æœ€åï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿå¦ä¸€æ¬¡ç‚¹å‡»ï¼Œæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ¢å¤ä¸ºé»˜è®¤å€¼:

```
userEvent.click(screen.getByText('Switch state'))
expect(screen.getByText("It's on!")).toBeInTheDocument() 
```

æœ€åï¼Œæˆ‘ä»¬å°†ç¼–å†™å¦ä¸€ä¸ªæµ‹è¯•æ¥éªŒè¯æ–‡æœ¬è¾“å…¥åŠå…¶åˆ‡æ¢æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

```
import { render, screen } from '@testing-library/react'
import userEvent from '@testing-library/user-event'
import About from './About'

describe('About', () => {

  ...

  test('Input works correctly', async () => {
    render( <About/> )

    userEvent.type(screen.getByTestId("testInput"), "Testing the test")
    userEvent.click(screen.getByText("Print input"))

    expect(screen.getByText("Testing the test")).toBeInTheDocument()

    userEvent.click(screen.getByText("Print input"))
    expect(screen.queryByText("Testing the test")).not.toBeInTheDocument()
  })

}) 
```

*   æˆ‘ä»¬å†æ¬¡ä½¿ç”¨`userEvent`æ¥æ¨¡æ‹Ÿæ–‡æœ¬è¢«å†™å…¥æˆ‘ä»¬çš„è¾“å…¥å…ƒç´ :`userEvent.type(screen.getByTestId("testInput"), "Testing the test")`
*   ç„¶åï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿå•å‡»åˆ‡æ¢æŒ‰é’®ï¼Œå¹¶æ£€æŸ¥æ–‡æ¡£ä¸­çš„è¾“å…¥æ–‡æœ¬:

```
userEvent.click(screen.getByText("Print input"))
expect(screen.getByText("Testing the test")).toBeInTheDocument() 
```

*   æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿå¦ä¸€æ¬¡ç‚¹å‡»å¹¶æ£€æŸ¥æµ‹è¯•æ˜¯å¦ä¸å†å­˜åœ¨æ¥ç»“æŸ:

```
userEvent.click(screen.getByText("Print input"))
expect(screen.getByText("Testing the test")).toBeInTheDocument() 
```

æ‚¨å¯ä»¥çœ‹åˆ°æµ‹è¯•åº“æä¾›çš„å®ç”¨ç¨‹åºæœ‰å¤šå¥½ï¼Œå°†å®ƒä»¬ä¸ Jest ç»“åˆèµ·æ¥æœ‰å¤šå®¹æ˜“ã€‚ğŸ¤“

æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ`npm test -- About.test.jsx`æ¥è¿è¡Œè¿™ä¸ªç‰¹å®šçš„æµ‹è¯•æ–‡ä»¶ï¼Œè¿™æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç»“æœ:

```
// console
PASS  src/components/About.test.jsx
  About
    âœ“ About renders correctly (34 ms)
    âœ“ Switch state works correctly (66 ms)
    âœ“ Input works correctly (67 ms)

Test Suites: 1 passed, 1 total
Tests:       3 passed, 3 total
Snapshots:   0 total
Time:        0.997 s, estimated 1 s
Ran all test suites matching /About.test.jsx/i. 
```

æˆ‘æƒ³å±•ç¤ºçš„æœ€åä¸€ä¸ª Jest ç‰¹æ€§æ˜¯**æµ‹è¯•è¦†ç›–ç‡**ã€‚
æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ`npm test -- --coverage`è·å¾—è¦†ç›–æŠ¥å‘Šã€‚

è¿™å°†æ­£å¸¸è¿è¡Œæ‚¨çš„æµ‹è¯•ï¼Œåœ¨ç»“æœæŠ¥å‘Šçš„æœ€åï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:

```
// console
...

----------------|---------|----------|---------|---------|-------------------
File            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
----------------|---------|----------|---------|---------|-------------------
All files       |      75 |      100 |   85.71 |      70 |                   
 src            |       0 |      100 |       0 |       0 |                   
  App.jsx       |       0 |      100 |       0 |       0 | 7                 
  App.t.js      |       0 |        0 |       0 |       0 |                   
  index.js      |       0 |      100 |     100 |       0 | 5-6               
 src/components |     100 |      100 |     100 |     100 |                   
  About.jsx     |     100 |      100 |     100 |     100 |                   
----------------|---------|----------|---------|---------|------------------- 
```

åœ¨æŠ¥å‘Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„`About.jsx`ç»„ä»¶è¢«å®Œå…¨è¦†ç›–ï¼Œä½†æ˜¯æˆ‘ä»¬çš„`App.jsx`å’Œ`index.js`æ–‡ä»¶æ²¡æœ‰è¢«æµ‹è¯•ã€‚

è¿™ä¸ªç‰¹æ€§åœ¨å¤„ç†å¤§é¡¹ç›®æ—¶éå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”æ‚¨æƒ³å¿«é€ŸçŸ¥é“æ‚¨çš„å¤§éƒ¨åˆ†ä»£ç æ˜¯å¦è¢«æ­£ç¡®æµ‹è¯•ã€‚

# å¦‚ä½•ç”¨ Cypress æµ‹è¯•å‰ç«¯ React åº”ç”¨ç¨‹åº

æˆ‘ä»¬å·²ç»è°ˆè®ºäº†å¾ˆå¤šå…³äº Jest çš„å†…å®¹ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Cypress æµ‹è¯•æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚

æˆ‘ä»¬å°†é€šè¿‡è¿è¡Œ`npm i -D cypress`æ¥å®‰è£… Cypressã€‚

è¿™åº”è¯¥ä¼šæ·»åŠ åˆ°æˆ‘ä»¬çš„`package.json`:

```
"devDependencies": {
    "cypress": "^9.5.4"
} 
```

ç„¶åæˆ‘ä»¬å°±è·‘`npx cypress open`ã€‚è¿™å°†æ‰“å¼€ Cypress æµè§ˆå™¨ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ª`cypress`ç›®å½•ã€‚åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ç¤ºä¾‹ã€æ–‡æ¡£å’Œé…ç½®é€‰é¡¹ã€‚

ä½ ä¹Ÿå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªâ€œé›†æˆâ€æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠæˆ‘ä»¬çš„æµ‹è¯•æ”¾åœ¨é‡Œé¢ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­åˆ›å»ºæˆ‘ä»¬çš„`About.test.js`æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶æˆ‘ä»¬åœ¨ Jest ä¸­çœ‹åˆ°çš„ç›¸åŒæµ‹è¯•ç¤ºä¾‹:

```
// About.test.js
describe('AboutPage', () => {
    it('Renders correctly', () => {
        cy.visit('http://localhost:3000/about')
        cy.contains("I'm the about page!")
    })

    it('switch btn toggles text', () => {
        cy.contains("It's on!")
        cy.get('.switchBtn').click()
        cy.contains("It's rolling!")
        cy.get('.switchBtn').click()
        cy.contains("It's on!")
    })

    it('Input works correctly', () => {
        cy.get(".testInput").type("Testing the test")
        cy.get('.printInputBtn').click()
        cy.contains("Testing the test")

        cy.get('.printInputBtn').click()
        cy.contains("Testing the test").should('not.exist')
    })
}) 
```

*   `describe`å‡½æ•°çš„å·¥ä½œåŸç†å’Œ jest ä¸­çš„ä¸€æ ·ã€‚
*   `it()`ä¸æˆ‘ä»¬ä¹‹å‰è§è¿‡çš„`test()`å‡½æ•°ç›¸åŒã€‚
*   åœ¨ç¬¬ä¸€ä¸ªæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å‘Šè¯‰æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ URLï¼Œå¹¶æ£€æŸ¥ç›¸åº”çš„æ–‡æœ¬æ˜¯å¦å·²å‘ˆç°:

```
cy.visit('http://localhost:3000/about')
cy.contains("I'm the about page!") 
```

*   ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥é»˜è®¤çš„åˆ‡æ¢æ–‡æœ¬æ˜¯å¦å·²å‘ˆç°ï¼Œæ¨¡æ‹Ÿä¸€æ¬¡å•å‡»å¹¶æ£€æŸ¥å®ƒæ˜¯å¦ç›¸åº”åœ°å‘ç”Ÿäº†å˜åŒ–:

```
cy.contains("It's on!")
cy.get('.switchBtn').click()
cy.contains("It's rolling!")
cy.get('.switchBtn').click()
cy.contains("It's on!") 
```

*   æœ€åï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªæ–‡æœ¬è¾“å…¥ï¼Œæ¨¡æ‹Ÿä¸€æ¬¡ç‚¹å‡»ï¼Œå¹¶æ£€æŸ¥è¾“å…¥æ–‡æœ¬æ˜¯å¦è¢«å‘ˆç°:

```
cy.get(".testInput").type("Testing the test")
cy.get('.printInputBtn').click()
cy.contains("Testing the test")

cy.get('.printInputBtn').click()
cy.contains("Testing the test").should('not.exist') 
```

syntaxt ä¸ Jest ç•¥æœ‰ä¸åŒï¼Œä½†å…¶æ€æƒ³å’Œç»“æ„å‡ ä¹æ˜¯ç›¸åŒçš„ã€‚ğŸ¤™

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å†æ¬¡è¿è¡Œ`npx cypress open`ï¼Œå°†ä¼šæ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œå†…å®¹å¦‚ä¸‹:
![2022-04-23_22-30](img/b587d9d9872d6b2c97f1da61b891bfba.png)

æˆ‘ä»¬å¯ä»¥ç‚¹å‡»â€œRun integration spec â€,æˆ‘ä»¬çš„æµ‹è¯•å°†åœ¨æ¨¡æ‹Ÿæµè§ˆå™¨ä¸­è‡ªåŠ¨è¿è¡Œã€‚æµ‹è¯•è¿è¡Œåï¼Œæˆ‘ä»¬å°†åœ¨å·¦ä¾§é¢æ¿çœ‹åˆ°ç»“æœ:
![2022-04-23_22-31](img/64f50a442e957078683f5e5bb93ef5b3.png)

æˆ‘ä»¬å¯ä»¥æ‰“å¼€è¿™äº›ç»“æœæ¥æŸ¥çœ‹æµ‹è¯•æ‰§è¡Œçš„æ¯ä¸€æ­¥ã€‚å¦‚æœæˆ‘ä»¬å°†é¼ æ ‡æ‚¬åœåœ¨æ¯ä¸ªæ­¥éª¤ä¸Šï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒåœ¨æµè§ˆå™¨ä¸­å®æ—¶æ‰§è¡Œã€‚æŸæ ‘çš„ä¸€ä¸ªçœŸæ­£ç”œç¾çš„ç‰¹å¾ã€‚ğŸ‘ŒğŸ‘Œ

![2022-04-23_22-34](img/4f9c426ad202645c2f7b206a219f06de.png)

å¦‚æ‚¨æ‰€è§ï¼Œç”¨ Cypress è®¾ç½®æµ‹è¯•éå¸¸å®¹æ˜“ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰ Jestï¼Œä½ å¯ä»¥å¾ˆå¿«æŒæ¡å®ƒï¼Œå› ä¸ºå®ƒçš„è¯­æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚

å¦‚æœæ‚¨æƒ³çŸ¥é“åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­åŒæ—¶ä½¿ç”¨ Jest å’Œ Cypress ä½œä¸ºæµ‹è¯•è¿è¡Œç¨‹åºæ˜¯å¦æœ‰æ„ä¹‰ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ªå †æ ˆæº¢å‡º answe r å¾ˆå¥½åœ°æ€»ç»“äº†è¿™ä¸€ç‚¹ã€‚

# å¦‚ä½•æµ‹è¯•åç«¯èŠ‚ç‚¹åº”ç”¨ç¨‹åº

ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å¯¹æµ‹è¯•å‰ç«¯åº”ç”¨ç¨‹åºçš„æ–¹æ³•æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œè®©æˆ‘ä»¬è¿‡æ²³ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç±»ä¼¼çš„å·¥å…·æ¥æµ‹è¯•åç«¯åº”ç”¨ç¨‹åºã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåªæœ‰ 3 ä¸ªç«¯ç‚¹çš„ç®€å•èŠ‚ç‚¹å’Œ Express APIã€‚

åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œè¿è¡Œ`npm init -y`åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ appã€‚è¿è¡Œ`npm i express`å®‰è£… Expressï¼Œç„¶åè¿è¡Œ`npm i -D jest supertest`å®‰è£… Jest å’Œ Supertest ä½œä¸ºå¼€å‘ä¾èµ–ã€‚

åœ¨ä½ çš„`package.json`é‡Œé¢ï¼ŒåŠ ä¸Š`"scripts": { "test": "jest" }`ã€‚
ä½ çš„æ•´ä¸ª`package.json`åº”è¯¥æ˜¯è¿™æ ·çš„:

```
{
  "dependencies": {
    "express": "^4.17.3"
  },
  "devDependencies": {
    "jest": "^27.5.1",
    "supertest": "^6.2.2"
  },
    "scripts": {
    "test": "jest"
  }
} 
```

ç„¶ååˆ›å»ºä¸€ä¸ª`app.js`æ–‡ä»¶ï¼Œå¹¶å°†è¿™æ®µä»£ç æ”¾å…¥å…¶ä¸­:

```
// app.js
/* Import and initialize express */
const express = require('express')
const app = express()
const server = require('http').Server(app)
/* Global middlewares */
app.use(express.json())

/* Endpoint 1 */
app.get('/', async (req, res) => {

    try {
        res.status(200).json({ greeting: "Hello there!" })
    } catch (err) {
        res.status(500).send(err)
    }
})

/* Endpoint 2 */
app.get('/isPalindrome', async (req, res) => {

    try {
        const string = req.body.string
        let result = true        
        let left = 0
        let right = string.length-1

        while (left < right && result) {
            if (string[left] === string[right]) {
                left += 1
                right -= 1
            }
            else result = false
        }

        res.status(200).json({ result: result })

    } catch (err) {
        res.status(500).send(err)
    }
})

/* Endpoint 3 */
app.get('/twoSum', async (req, res) => {

    try {
        const nums = JSON.parse(req.body.nums)
        const target = JSON.parse(req.body.target)

        let result = false

        for (let i = 0; i < nums.length; i++) {
            const neededNum = target - nums[i]
            if (nums.indexOf(neededNum) !== -1 && nums.indexOf(neededNum) !== i) result = [nums[i], nums[nums.indexOf(neededNum)]]
        }

        res.status(200).json({ result: result })

    } catch (err) {
        res.status(500).send(err)
    }
})

/* Export server object */
module.exports = server

/* Initialize server */
server.listen(3001, () => console.log('Server is listening.') )
server.on('error', error => console.error(error) ) 
```

å¦‚æ‚¨æ‰€è§ï¼Œç«¯ç‚¹ 1 åªæ˜¯è¿”å›ä¸€æ¡é—®å€™æ¶ˆæ¯ã€‚ç«¯ç‚¹ 2 å’Œ 3 æ˜¯æˆ‘ä»¬åœ¨æ™®é€š JS ç¤ºä¾‹ä¸­çœ‹åˆ°çš„å‡½æ•°çš„æ”¹ç¼–ã€‚ä»–ä»¬ç°åœ¨æ¥æ”¶è¯·æ±‚ä¸­çš„å‚æ•°ï¼Œè¿”å›å€¼åœ¨å“åº”ä¸­ã€‚ğŸ˜‰

ç°åœ¨æµ‹è¯•ï¼åˆ›å»ºä¸€ä¸ª`app.test.js`æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹ä»£ç æ”¾å…¥å…¶ä¸­:

```
// app.test.js
const supertest = require('supertest') // Import supertest
const server = require("./app") // Import the server object
const requestWithSupertest = supertest(server) // We will use this function to mock HTTP requests

afterEach(done => { // afterEach function is provided by Jest and executes once all tests are finished
    server.close() // We close the server connection once all tests have finished
    done()
})

test('GET "/" returns greeting', async () => {
    const res = await requestWithSupertest.get('/')
    expect(res.status).toEqual(200)
    expect(res.type).toEqual(expect.stringContaining('json'))
    expect(res.body).toEqual({ greeting: "Hello there!" })
})

describe("/isPalindrome", () => {
    test('GET "/isPalindrome" neuquen returns true', async () => {
        const res = await requestWithSupertest.get('/isPalindrome').set('Content-type', 'application/json').send({ "string":"neuquen" })
        expect(res.status).toEqual(200)
        expect(res.type).toEqual(expect.stringContaining('json'))
        expect(res.body).toEqual({ result: true })
    })

    test('GET "/isPalindrome" bariloche returns true', async () => {
        const res = await requestWithSupertest.get('/isPalindrome').set('Content-type', 'application/json').send({ "string":"bariloche" })
        expect(res.status).toEqual(200)
        expect(res.type).toEqual(expect.stringContaining('json'))
        expect(res.body).toEqual({ result: false })
    })
})

describe("/twoSum", () => {
    test('GET "/twoSum" [2,7,11,15] and 9 returns [7, 2]', async () => {
        const res = await requestWithSupertest.get('/twoSum').set('Content-type', 'application/json').send({ "nums":"[2,7,11,15]", "target": "9" })
        expect(res.status).toEqual(200)
        expect(res.type).toEqual(expect.stringContaining('json'))
        expect(res.body).toEqual({ result: [7, 2] })
    })

    test('GET "/twoSum" [3,2,4] and 6 returns [4, 2]', async () => {
        const res = await requestWithSupertest.get('/twoSum').set('Content-type', 'application/json').send({ "nums":"[3,2,4]", "target": "6" })
        expect(res.status).toEqual(200)
        expect(res.type).toEqual(expect.stringContaining('json'))
        expect(res.body).toEqual({ result: [4, 2] })
    })

    test('GET "/twoSum" [3,2,4] and 10 returns false', async () => {
        const res = await requestWithSupertest.get('/twoSum').set('Content-type', 'application/json').send({ "nums":"[3,2,4]", "target": "10" })
        expect(res.status).toEqual(200)
        expect(res.type).toEqual(expect.stringContaining('json'))
        expect(res.body).toEqual({ result: false })
    })
}) 
```

è®©æˆ‘ä»¬åˆ†æä¸€ä¸‹æˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…:

*   æˆ‘ä»¬ç”¨`requestWithSupertest.get('/')`æ¨¡æ‹Ÿè¯·æ±‚
*   ç„¶åæˆ‘ä»¬å°†`res`å¯¹è±¡åˆ†æˆå‡ éƒ¨åˆ†ï¼Œå¹¶æ–­è¨€å®ƒçš„æ¯ä¸€éƒ¨åˆ†:
    *   æ£€æŸ¥å“åº”çŠ¶æ€:`expect(res.status).toEqual(200)`
    *   æŸ¥çœ‹å“åº”æ ¼å¼:`expect(res.type).toEqual(expect.stringContaining('json'))`
    *   æ£€æŸ¥å“åº”æ­£æ–‡å†…å®¹:`expect(res.body).toEqual({ greeting: "Hello there!" })`

å…¶ä»–æµ‹è¯•éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯æˆ‘ä»¬åœ¨æ¨¡æ‹Ÿè¯·æ±‚ä½“ä¸­å‘é€æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
const res = await requestWithSupertest.get('/isPalindrome').set('Content-type', 'application/json').send({ "string":"bariloche" }) 
```

å¦‚æ‚¨æ‰€è§ï¼Œä¸€æ—¦æ‚¨ç†Ÿæ‚‰ Jestï¼Œä»¥è¿™ç§æ–¹å¼è¿›è¡Œæµ‹è¯•çœŸçš„å¾ˆç®€å•ã€‚æˆ‘ä»¬åªéœ€è¦ Supertest çš„ä¸€ç‚¹å¸®åŠ©æ¥æ¨¡æ‹Ÿ HTTP è¯·æ±‚ï¼Œå‰©ä¸‹çš„åªæ˜¯æ–­è¨€å“åº”ã€‚ğŸ‘ğŸ‘

æˆ‘ä»¬å¯ä»¥ç”¨`npm test`è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°å¦‚ä¸‹å“åº”:

```
// console
 PASS  ./app.test.js
  âœ“ GET "/" returns greeting (46 ms)
  /isPalindrome
    âœ“ GET "/isPalindrome" neuquen returns true (18 ms)
    âœ“ GET "/isPalindrome" bariloche returns true (3 ms)
  /twoSum
    âœ“ GET "/twoSum" [2,7,11,15] and 9 returns [7, 2] (4 ms)
    âœ“ GET "/twoSum" [3,2,4] and 6 returns [4, 2] (3 ms)
    âœ“ GET "/twoSum" [3,2,4] and 10 returns false (2 ms)

Test Suites: 1 passed, 1 total
Tests:       6 passed, 6 total
Snapshots:   0 total
Time:        0.552 s, estimated 1 s
Ran all test suites. 
```

# åŒ…è£¹

å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬å·²ç»ä»‹ç»äº†å››ç§éå¸¸æµè¡Œçš„å·¥å…·çš„åŸºç¡€çŸ¥è¯†ï¼Œå®ƒä»¬å°†å…è®¸æ‚¨æµ‹è¯• JS åº”ç”¨ç¨‹åºçš„å‰ç«¯å’Œåç«¯ã€‚

å½“ç„¶ï¼Œé™¤äº†æˆ‘ä»¬å·²ç»çœ‹åˆ°çš„æ‰€æœ‰å·¥å…·ï¼Œè¿˜æœ‰å¾ˆå¤šæˆ‘ä»¬æ²¡æœ‰æ¶‰åŠåˆ°çš„ç‰¹æ€§ã€‚ä½†æ˜¯è¿™ä¸ªæƒ³æ³•æ˜¯ç»™ä½ ä¸€ä¸ªä»‹ç»ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨æµ‹è¯•ä¸–ç•Œé‡Œè¿ˆå‡ºç¬¬ä¸€æ­¥ã€‚

ä¸€å¦‚æ—¢å¾€ï¼Œæˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶å­¦åˆ°ä¸€äº›æ–°ä¸œè¥¿ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ [linkedin](https://www.linkedin.com/in/germancocca/) æˆ– [twitter](https://twitter.com/CoccaGerman) ä¸Šå…³æ³¨æˆ‘ã€‚

å¹²æ¯ï¼Œä¸‹æœŸå†è§ï¼=D

![goodbye-bye--1-](img/92d11df47a901c35772ea58632a38834.png)