# å¦‚ä½•ä½¿ç”¨ Gradio ä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹æ„å»º GUI

> åŸæ–‡ï¼š<https://www.freecodecamp.org/news/build-gui-using-gradio-for-machine-learning-models/>

å¦‚æœä½ æ›¾ç»å»ºç«‹è¿‡ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä½ å¯èƒ½ä¼šæƒ³â€œè¿™å¾ˆé…·ï¼Œä½†æ˜¯å…¶ä»–äººæ€ä¹ˆèƒ½çœ‹åˆ°å®ƒæœ‰å¤šé…·å‘¢ï¼Ÿâ€

æ¨¡å‹éƒ¨ç½²æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€éƒ¨åˆ†ï¼Œä½†å¹¶æ²¡æœ‰å¾—åˆ°åº”æœ‰çš„é‡è§†ã€‚

å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨ä»‹ç»ä¸€ç§æ–°å·¥å…·ï¼Œå®ƒå°†å¸®åŠ©æ‚¨ä¸ºæ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹ç”Ÿæˆä¸€ä¸ª web åº”ç”¨ç¨‹åºï¼Œç„¶åæ‚¨å¯ä»¥ä¸å…¶ä»–å¼€å‘äººå‘˜å…±äº«è¯¥åº”ç”¨ç¨‹åºï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥è¯•ç”¨å®ƒã€‚

æˆ‘å°†ä½¿ç”¨ scikit-learn æ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ Gradio ä¸ºè¯¥æ¨¡å‹åˆ›å»ºä¸€ä¸ª GUI(è¿™æ˜¯æˆ‘è¯´è¿‡çš„å¾ˆé…·çš„æ–°å·¥å…·)ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

> æˆ‘ä»¬ä¸èƒ½ç”¨åˆ¶é€ é—®é¢˜çš„æ€ç»´æ¥è§£å†³é—®é¢˜-é˜¿å°”ä¼¯ç‰¹Â·çˆ±å› æ–¯å¦

# æ ¼æ‹‰è¿ªæ¬§æ˜¯ä»€ä¹ˆï¼Ÿ

![gradio cover.png](img/400830d17f198fac774191164ba7dd38.png)

****image credits: [gradio](https://gradio.app/)****

æ® [Gradio ç½‘ç«™](https://gradio.app/)ï¼Œ

> Gradio å…è®¸æ‚¨å›´ç»• TensorFlow æˆ– PyTorch æ¨¡å‹ç”šè‡³ä»»æ„ Python å‡½æ•°å¿«é€Ÿåˆ›å»ºå¯å®šåˆ¶çš„ UI ç»„ä»¶ã€‚

å—¯ï¼Œè¿™å¯ä¸æ˜¯ä»€ä¹ˆå¥½æ¶ˆæ¯ï¼Œå¯¹å§ï¼ŸğŸ˜…ã€‚

å¦‚æœä½ æ›¾ç»ç”¨è¿‡ Tkinter è¿™æ ·çš„ Python GUI åº“ï¼Œé‚£ä¹ˆ Gradio å°±æ˜¯é‚£æ ·çš„ã€‚

Gradio æ˜¯ä¸€ä¸ª GUI åº“ï¼Œå…è®¸æ‚¨ä¸ºæ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹åˆ›å»ºå¯å®šåˆ¶çš„ GUI ç»„ä»¶ã€‚

ç°åœ¨æˆ‘ä»¬äº†è§£äº† Gradio æ˜¯ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬è¿›å…¥é¡¹ç›®ã€‚

## **å…ˆå†³æ¡ä»¶**

ä¸ºäº†æˆåŠŸå®Œæˆæœ¬æ•™ç¨‹ï¼Œæ‚¨éœ€è¦å®‰è£… Pythonã€‚

# è®©æˆ‘ä»¬å¼€å§‹å»ºé€ å§

ä½ å¯ä»¥ç‚¹å‡»æŸ¥çœ‹é¡¹ç›®[çš„ GitHub repoã€‚ç°åœ¨æˆ‘å°†å¸¦ä½ ä¸€æ­¥ä¸€æ­¥åœ°å®Œæˆè¿™ä¸ªé¡¹ç›®ã€‚](https://github.com/EdemGold/gradio_project)

### å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…

è®©æˆ‘ä»¬å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…:

```
pip install sklearn 
```

```
pip install pandas 
```

```
pip install numpy 
```

```
pip install gradio 
```

### è·å–æˆ‘ä»¬çš„æ•°æ®

æˆ‘ä»¬çš„æ•°æ®å°†ä¼šåœ¨ã€‚CSV æ ¼å¼ã€‚ç‚¹å‡»[è¿™é‡Œ](https://raw.githubusercontent.com/EdemGold/gradio_project/main/diabetes.csv)å¯ä»¥å¾—åˆ°æ•°æ®ã€‚

### å¯¼å…¥åŒ…

æˆ‘ä»¬å°†åƒè¿™æ ·å¯¼å…¥æ‰€éœ€çš„åŒ…:

```
import numpy as np

import pandas as pd

import gradio as gr 
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¿‡æ»¤è­¦å‘Šï¼Œä½¿æˆ‘ä»¬çœ‹ä¸åˆ°å®ƒä»¬ã€‚

```
import warnings

warnings.filterwarnings('ignore') 
```

### å¯¼å…¥æ•°æ®

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¯¼å…¥æ•°æ®:

```
data = pd.read_csv('diabetes.csv') 
```

ç°åœ¨è®©æˆ‘ä»¬ç”¨è¿™ä¸ªå‘½ä»¤é¢„è§ˆä¸€ä¸‹æˆ‘ä»¬çš„æ•°æ®é›†:

```
data.head() 
```

è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®é›†ä¸­çš„è¦ç´ åˆ—:

```
print (data.columns) 
```

### è·å–æˆ‘ä»¬çš„å˜é‡

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¾—åˆ° X å’Œ Y å˜é‡ï¼Œæ‰€ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤:

```
x = data.drop(['Outcome'], axis=1)

y = data['Outcome'] 
```

### æ‹†åˆ†æ•°æ®

ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨ scikit-learn å†…ç½®çš„ *train_test_split* å‡½æ•°æ¥æ‹†åˆ†æˆ‘ä»¬çš„æ•°æ®ã€‚

```
from sklearn.model_selection import train_test_split

x_train, x_test, y_train, y_test = train_test_split(x,y) 
```

### æ‰©å±•æˆ‘ä»¬çš„æ•°æ®

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ scikit-learn çš„å†…ç½® *StandardScaler* å¯¹è±¡æ¥ç¼©æ”¾æˆ‘ä»¬çš„æ•°æ®ã€‚

```
from sklearn.preprocessing import StandardScaler

#instantiate StandardScaler object
scaler = StandardScaler()

#scale data
x_train_scaled = scaler.fit_transform(x_train)

x_test_scaled = scaler.fit_transform(x_test) 
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é€šè¿‡ scikit-learn æä¾›ç»™æˆ‘ä»¬çš„ StandardScaler å¯¹è±¡æ¥ç¼©æ”¾æˆ‘ä»¬çš„æ•°æ®ã€‚è¦äº†è§£æ›´å¤šå…³äºç¼©æ”¾ä»¥åŠæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšçš„ä¿¡æ¯ï¼Œè¯·ç‚¹å‡»[æ­¤å¤„](https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/)ã€‚

### å®ä¾‹åŒ–å¹¶è®­ç»ƒæ¨¡å‹

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå¹¶è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚æˆ‘ä»¬è¦ä½¿ç”¨çš„æ¨¡å‹å°†æ˜¯ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥å™¨åˆ†ç±»å™¨ï¼Œä¸€ä¸ªå†…ç½®åœ¨ scikit-learn ä¸­çš„ç¥ç»ç½‘ç»œã€‚

```
#import model object
from sklearn.neural_network import MLPClassifier
model =  MLPClassifier(max_iter=1000,  alpha=1)

#train model on training data
model.fit(x_train_scaled, y_train)

#getting model performance on test data
print("accuracy:", model.score(x_test_scaled, y_test)) 
```

### ä¸º Gradio åˆ›å»ºå‡½æ•°

ç°åœ¨æœ‰è¶£çš„éƒ¨åˆ†æ¥äº†ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ¥å—æˆ‘ä»¬çš„æ¨¡å‹æ‰€è®­ç»ƒçš„æ•°æ®é›†çš„ç‰¹å¾ï¼Œå¹¶å°†å…¶ä½œä¸ºæ•°ç»„ä¼ é€’ç»™æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åŸºäºè¯¥åŠŸèƒ½æ„å»ºæˆ‘ä»¬çš„ Gradio web åº”ç”¨ç¨‹åºã€‚

è¦ç†è§£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½ é¦–å…ˆè¦ç†è§£ Gradio æ˜¯åŸºäºå‡½æ•°ä¸ºæˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹æ„å»º GUI ç»„ä»¶çš„ã€‚è¯¥å‡½æ•°ä¸º Gradio æä¾›äº†ä¸€ç§ä»ç”¨æˆ·å¤„è·å–è¾“å…¥å¹¶å°†å…¶ä¼ é€’ç»™ ML æ¨¡å‹çš„æ–¹æ³•ï¼ŒML æ¨¡å‹å°†å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œç„¶åå°†å…¶ä¼ é€’å› Gradioï¼ŒGradio å†å°†ç»“æœä¼ é€’å‡ºå»ã€‚

è®©æˆ‘ä»¬å†™ä¸€äº›ä»£ç ...

é¦–å…ˆï¼Œæˆ‘ä»¬å°†è·å¾—ç‰¹æ€§åˆ—ï¼Œç„¶åå°†è¿™äº›ç‰¹æ€§åˆ—ä¼ é€’ç»™æˆ‘ä»¬çš„å‡½æ•°ã€‚

```
#geting our columns

print(data.columns) 
```

ç°åœ¨æˆ‘ä»¬å°†åˆ›å»ºè¿™æ ·çš„å‡½æ•°:

```
def diabetes(Pregnancies, Glucose, Blood_Pressure, SkinThickness, Insulin, BMI, Diabetes_Pedigree, Age):
#turning the arguments into a numpy array  

 x = np.array([Pregnancies,Glucose,Blood_Pressure,SkinThickness,Insulin,BMI,Diabetes_Pedigree,Age])

  prediction = model.predict(x.reshape(1, -1))

  return prediction 
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†æ•°æ®ä¸­çš„ç‰¹å¾åˆ—ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°†å®ƒå‘½åä¸º *diabetes* ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å‚æ•°è½¬æ¢æˆä¸€ä¸ª NumPy æ•°ç»„ï¼Œç„¶åä¼ é€’ç»™æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚æœ€åæˆ‘ä»¬è¿”å›äº†æ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚

### åˆ›å»ºæˆ‘ä»¬çš„ Gradio ç•Œé¢

ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Gradio åˆ›å»ºæˆ‘ä»¬çš„ Web åº”ç”¨ç¨‹åºç•Œé¢:

```
outputs = gr.outputs.Textbox()

app = gr.Interface(fn=diabetes, inputs=['number','number','number','number','number','number','number','number'], outputs=outputs,description="This is a diabetes model") 
```

æˆ‘ä»¬åœ¨ä¸Šé¢åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º outputs çš„å˜é‡ï¼Œå®ƒä¿å­˜äº†æ¨¡å‹ç»“æœçš„ GUI ç»„ä»¶ã€‚æˆ‘ä»¬çš„æ¨¡å‹çš„é¢„æµ‹ç»“æœå°†åœ¨ä¸€ä¸ªæ–‡æœ¬æ¡†ä¸­è¾“å‡ºã€‚

ç„¶åï¼Œæˆ‘ä»¬å®ä¾‹åŒ– Gradio æ¥å£å¯¹è±¡ï¼Œå¹¶ä¼ å…¥æˆ‘ä»¬ä¹‹å‰çš„*ç³–å°¿ç—…*å‡½æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”Ÿæˆäº†æˆ‘ä»¬çš„è¾“å…¥ GUI ç»„ä»¶ï¼Œå¹¶å‘Šè¯‰æ”¶éŸ³æœºä»¥æ•°å­—çš„å½¢å¼æœŸå¾… 8 ä¸ªè¾“å…¥ã€‚

è¾“å…¥è¡¨ç¤ºæˆ‘ä»¬çš„æ•°æ®é›†ä¸­å­˜åœ¨çš„ç‰¹å¾åˆ—â€”â€”ä¸æˆ‘ä»¬ä¼ é€’ç»™*ç³–å°¿ç—…*å‡½æ•°çš„ 8 ä¸ªç‰¹å¾åˆ—åç§°ç›¸åŒã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ä¹‹å‰çš„è¾“å‡ºå˜é‡ä¼ é€’ç»™å¯¹è±¡ä¸­çš„è¾“å‡ºå‚æ•°ã€‚

æœ€åï¼Œæˆ‘ä»¬å°† web åº”ç”¨ç¨‹åºçš„æè¿°ä¼ é€’åˆ°æè¿°å‚æ•°ä¸­ã€‚

### å¯åŠ¨ Gradio Web åº”ç”¨ç¨‹åº

ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ¨å‡ºæˆ‘ä»¬çš„ Gradio web åº”ç”¨ç¨‹åºã€‚

```
app.launch() 
```

**æ³¨æ„:**å¦‚æœæ‚¨ä» e å‘½ä»¤è¡Œä»¥è„šæœ¬å½¢å¼å¯åŠ¨ Gradio åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªæœ¬åœ°ä¸»æœºé“¾æ¥ï¼Œç„¶åæ‚¨å¯ä»¥å°†å…¶å¤åˆ¶å¹¶ç²˜è´´åˆ°æ‚¨çš„æµè§ˆå™¨ä¸­ï¼Œä»¥æŸ¥çœ‹æ‚¨çš„ web åº”ç”¨ç¨‹åºã€‚

å¦‚æœæ‚¨ä» Jupyter ç¬”è®°æœ¬ä¸Šå¯åŠ¨åº”ç”¨ç¨‹åºï¼Œæ‚¨ä¼šåœ¨è¿è¡Œå•å…ƒæ—¶çœ‹åˆ°åº”ç”¨ç¨‹åºçš„å®æ—¶é¢„è§ˆ(è¿˜ä¼šæä¾›ä¸€ä¸ªé“¾æ¥)ã€‚

### æ‰˜ç®¡å’Œå…±äº«æ‚¨çš„ Web åº”ç”¨ç¨‹åº

å¦‚æœä½ æƒ³åˆ†äº«ä½ çš„ web åº”ç”¨ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯æŠŠ`share=True`ä½œä¸ºå‚æ•°æ”¾å…¥ä½ çš„ launch å¯¹è±¡ä¸­ã€‚

```
#To provide a shareable link
app.launch(share=True) 
```

ç„¶åï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªæ‰©å±•åä¸º. gradio çš„é“¾æ¥ã€‚ä½†æ˜¯è¿™ç§å¯å…±äº«çš„é“¾æ¥åªæŒç»­ 24 å°æ—¶ï¼Œå¹¶ä¸”åªæœ‰åœ¨ä½ çš„ç³»ç»Ÿè¿è¡Œçš„æƒ…å†µä¸‹æ‰ä¼šæŒç»­ã€‚å› ä¸º Gradio åªæ˜¯åœ¨ä½ çš„ç³»ç»Ÿä¸Šæ‰˜ç®¡ web åº”ç”¨ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œä¸ºäº†è®©ä½ çš„é“¾æ¥å·¥ä½œï¼Œä½ çš„ç³»ç»Ÿå¿…é¡»å¼€å¯ã€‚è¿™æ˜¯å› ä¸º Gradio ä½¿ç”¨æ‚¨çš„ç³»ç»Ÿæ¥æ‰˜ç®¡ web åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥ä¸€æ—¦æ‚¨çš„ç³»ç»Ÿå…³é—­ï¼ŒæœåŠ¡å™¨è¿æ¥å°±ä¼šè¢«åˆ‡æ–­ï¼Œæ‚¨å°±ä¼šå¾—åˆ° 500ğŸ˜…ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒGradio è¿˜ä¸ºæ‚¨æä¾›äº†æ°¸ä¹…æ‰˜ç®¡æ‚¨çš„æ¨¡å‹çš„æ–¹æ³•ã€‚ä½†æ˜¯è¿™é¡¹æœåŠ¡æ˜¯åŸºäºè®¢é˜…çš„ï¼Œæ‰€ä»¥ä½ å¿…é¡»æ¯æœˆæ”¯ä»˜ 7 ç¾å…ƒæ‰èƒ½ä½¿ç”¨ã€‚æ°¸ä¹…æ‰˜ç®¡è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´(éƒ¨åˆ†åŸå› æ˜¯ä½œè€…ç ´äº§äº†ğŸ˜…).ä½†æ˜¯å¦‚æœä½ å¯¹å®ƒæ„Ÿå…´è¶£ï¼Œç‚¹å‡»[è¿™é‡Œ](https://www.gradio.app/introducing-hosted)ã€‚

## **é‡è¦èµ„æº**

*   [Gradio ç½‘ç«™](https://gradio.app/)
*   [Gradio æ–‡æ¡£](https://gradio.app/docs)
*   [GitHub ä¸Šçš„ Gradio](https://github.com/gradio-app/gradio)

## **æ€»ç»“**

Gradio åº“çœŸçš„å¾ˆé…·ï¼Œå®ƒå¸®åŠ©è§£å†³äº†å›°æ‰°æœºå™¨å­¦ä¹ ç¤¾åŒºçš„ä¸€ä¸ªå·¨å¤§é—®é¢˜â€”â€”æ¨¡å‹éƒ¨ç½²ã€‚

90%çš„æœºå™¨å­¦ä¹ æ¨¡å‹æ²¡æœ‰éƒ¨ç½²ï¼ŒGradio æ­£åœ¨åŠªåŠ›è§£å†³è¿™ä¸€é—®é¢˜ã€‚

å®ƒä¹Ÿæ˜¯åˆå­¦è€…å’Œä¸“å®¶ç‚«è€€ä»–ä»¬çš„æ¨¡å‹çš„ä¸€ç§æ–¹å¼ï¼Œä¹Ÿæ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­æµ‹è¯•æ¨¡å‹çš„ä¸€ç§æ–¹å¼ã€‚

æ ¼æ‹‰è¿ªæ¬§å›¾ä¹¦é¦†ä¸ä¼šé”™çš„ã€‚è¯•è¯•çœ‹ã€‚

[å°é¢å›¾ç‰‡æ¥æº](https://res.cloudinary.com/crunchbase-production/image/upload/c_lpad,h_256,w_256,f_auto,q_auto:eco,dpr_1/tv8zrejyehjshagvxgt7)ã€‚