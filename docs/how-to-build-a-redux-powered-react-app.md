# å¦‚ä½•æ„å»ºåŸºäº Redux çš„ React åº”ç”¨ç¨‹åº

> åŸæ–‡ï¼š<https://www.freecodecamp.org/news/how-to-build-a-redux-powered-react-app/>

## æˆ‘ä»¬æ­£åœ¨è§£å†³çš„é—®é¢˜

åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªå°çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰ä¸€äº›ç»„ä»¶å£°æ˜å¹¶ä½¿ç”¨å®ƒä»¬è‡ªå·±çš„çŠ¶æ€ã€‚åœ¨å°‘æ•°æƒ…å†µä¸‹ï¼Œç»„ä»¶å¯èƒ½å¸Œæœ›ä¸å…¶ç›´æ¥å­ç»„ä»¶å…±äº«çŠ¶æ€ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å±€éƒ¨å£°æ˜çŠ¶æ€æ¥å¤„ç†è¿™äº›æƒ…å†µâ€”â€”å¦‚æœéœ€è¦çš„è¯ï¼Œå¯èƒ½ä»¥é“å…·çš„å½¢å¼å°†çŠ¶æ€ä¼ é€’ç»™å®ƒçš„å­ç»„ä»¶(ä¹Ÿç§°ä¸ºé“å…·é’»å–)ã€‚

ä½†æ˜¯å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºå˜å¤§äº†ï¼Œæ‚¨å¯èƒ½éœ€è¦å°†çŠ¶æ€ä¼ é€’ç»™ä¸€ä¸ªå­çº§ï¼Œè¿™ä¸ªå­çº§å¯èƒ½æ˜¯å±‚æ¬¡ç»“æ„ä¸­çš„ä¸‹ä¸€çº§ã€‚æ‚¨å¯èƒ½è¿˜éœ€è¦åœ¨å…„å¼Ÿç»„ä»¶ä¹‹é—´ä½¿ç”¨å…¬å…±çŠ¶æ€ã€‚

å½“ç„¶ï¼Œåœ¨å…„å¼Ÿç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒä»¬çš„çˆ¶ç»„ä»¶ä¸­å£°æ˜çŠ¶æ€ï¼Œç„¶åé€šè¿‡ prop drilling å°†çŠ¶æ€ä¼ é€’ç»™å®ƒä»¬çš„å­ç»„ä»¶ã€‚ä½†æ˜¯è¿™å¹¶ä¸æ€»æ˜¯å¯è¡Œçš„ï¼Œå¹¶ä¸”æœ‰å®ƒè‡ªå·±çš„ç¼ºç‚¹ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚

åªéœ€è€ƒè™‘ä¸‹å›¾:

![Group-49](img/ad8f197c5519c9888532a58c028f6ad0.png)

è¿™æ˜¯å…¸å‹ React åº”ç”¨ç¨‹åºä¸­ç»„ä»¶æ–‡ä»¶ç»“æ„çš„ç¤ºæ„å›¾ã€‚

å‡è®¾æˆ‘ä»¬éœ€è¦åœ¨å­©å­ 5 å’Œå­©å­ 6 ä¹‹é—´å…±äº«ä¸€ä¸ªå…±åŒçš„çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°åœ¨å®ƒä»¬çš„çˆ¶èŠ‚ç‚¹(å³å­èŠ‚ç‚¹ 2)ä¸­å£°æ˜ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶å°†è¯¥çŠ¶æ€ä¼ é€’ç»™ä¸¤ä¸ªå­èŠ‚ç‚¹(5 å’Œ 6)ã€‚

ç›®å‰ä¸€åˆ‡æ­£å¸¸ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦å­©å­ 3 ä¹Ÿæœ‰åŒæ ·çš„çŠ¶æ€å‘¢ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å­©å­ 5ã€6 å’Œ 3 çš„å…¬å…±çˆ¶/ç¥–çˆ¶ä¸­å£°æ˜çŠ¶æ€ï¼Œå³åº”ç”¨ç¨‹åºç»„ä»¶ã€‚

åŒæ ·ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨æ ‘ä¸­ç›¸è·å¾ˆè¿œçš„å­©å­ 4ã€11 å’Œ 10 ä¹‹é—´å…±äº«ä¸€ä¸ªçŠ¶æ€ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å°†å†æ¬¡éœ€è¦åœ¨ App ç»„ä»¶ä¸­åˆ›å»ºçŠ¶æ€ï¼Œç„¶åæ‰§è¡Œå¤šçº§ prop drillingï¼Œå°†çŠ¶æ€ä» App ä¼ é€’åˆ°è¿™äº›ç»„ä»¶ã€‚

å’Œä¹…è€Œä¹…ä¹‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œè¿™å°†å¼€å§‹ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç»„ä»¶æˆ–ä»»ä½•å…¶ä»–ç±»ä¼¼çš„å…¬å…±çˆ¶ç»„ä»¶ä¸ä¸å¿…è¦çš„çŠ¶æ€å£°æ˜æ··æ‚åœ¨ä¸€èµ·ã€‚è¿™äº›å£°æ˜ä¸è¢«è¿™äº›ç»„ä»¶ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯è¢«å®ƒä»¬çš„ä¸€äº›ä¸‹çº§ç»„ä»¶ä½¿ç”¨ã€‚

## å¤šæ­¥æ”¯æŸ±é’»å­”çš„ç¼ºç‚¹

å¤šçº§æ”¯æŸ±é’»æ¢ä¸»è¦æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚å®ƒä»¬æ˜¯:

*   ç»„ä»¶ä¸å¿…è¦çš„è†¨èƒ€:å¦‚ä¸Šæ‰€è¿°ï¼Œéšç€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå˜å¤§ï¼Œä¸€äº›å¸¸è§çš„çˆ¶ç»„ä»¶å¯èƒ½ä¼šå› ä¸ºä¸å¿…è¦çš„çŠ¶æ€å£°æ˜è€Œè†¨èƒ€ã€‚è¿™äº›ç»„ä»¶å¯èƒ½ä¸ä¼šç›´æ¥ä½¿ç”¨è¿™äº›å£°æ˜ï¼Œä½†æ˜¯å®ƒä»¬å¯èƒ½ä¼šè¢«å®ƒä»¬çš„ä¸€äº›è¿œäº²ä½¿ç”¨ã€‚å…¶ä»–ä¸€äº›ç»„ä»¶ä¹Ÿå¯èƒ½å˜å¾—è‡ƒè‚¿ï¼Œå®ƒä»¬åªæ˜¯ä½œä¸ºå­ç»„ä»¶çš„é€‚å½“ä¼ é€’è€…ã€‚è¿™ä¹Ÿä¼šå¯¹ä»£ç çš„å¯è¯»æ€§äº§ç”Ÿè´Ÿé¢å½±å“ã€‚
*   **ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“:**ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“å¯¹äºå®¢æˆ·ç«¯åº”ç”¨æ¥è¯´æ˜¯ä¸€ä¸ªå¤§å¿Œã€‚ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ä¼šä½¿åº”ç”¨ç¨‹åºå˜å¾—ç¼“æ…¢ã€æ»åã€ååº”è¿Ÿé’ï¼Œå¹¶ç»™ç”¨æˆ·å¸¦æ¥ç³Ÿç³•çš„ä½“éªŒã€‚åœ¨ React ä¸­ï¼Œé‡æ–°æ¸²æŸ“æ˜¯ç”±çŠ¶æ€æˆ–å±æ€§å˜åŒ–ä»¥åŠå…¶ä»–åŸå› å¼•èµ·çš„ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶å®é™…ä¸Šå¹¶æ²¡æœ‰ä½¿ç”¨ä¸€ä¸ªçŠ¶æ€ï¼Œè€Œåªæ˜¯ä½œä¸ºé“å…·ä»çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶çš„é€šé“ï¼Œé‚£ä¹ˆå½“çŠ¶æ€/é“å…·æ”¹å˜æ—¶ï¼Œå®ƒä¹Ÿå¯èƒ½è¢«ä¸å¿…è¦åœ°é‡æ–°æ¸²æŸ“ã€‚çœ‹ä¸‹é¢çš„å›¾ç‰‡å¯ä»¥æ›´å¥½åœ°ç†è§£å®ƒ

![Group-52-1](img/ba8504841f93ed1cf37f042a388ed743.png)

## è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆ

è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨ Redux æˆ– MobX è¿™æ ·çš„çŠ¶æ€ç®¡ç† appï¼Œä»¥æ›´ç»Ÿä¸€ã€æ›´é«˜æ•ˆçš„æ–¹å¼å¤„ç†ä¸Šè¿°çŠ¶æ€ç®¡ç†åœºæ™¯çš„åŸå› ã€‚

åœ¨åƒ Redux è¿™æ ·çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨å±€çŠ¶æ€ï¼Œå¹¶å°†å…¶æ”¾åœ¨ä¸€ä¸ªå­˜å‚¨ä¸­ã€‚æ— è®ºå“ªä¸ªç»„ä»¶éœ€è¦è¯¥å­˜å‚¨ä¸­çš„ä»»ä½•çŠ¶æ€ï¼Œéƒ½å¯ä»¥é€šè¿‡è®¢é˜…è¯¥å­˜å‚¨è½»æ¾è·å¾—ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‘†è„±ä»¥ä¸Šä¸¤ä¸ªç¼ºç‚¹ã€‚

*   **æ•´ç†ç»„ä»¶:**ä»â€œå®é™…â€ä½¿ç”¨å®ƒçš„ç»„ä»¶æŒ‰éœ€è·å–çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡åˆ é™¤æ‰€æœ‰ä¸å¿…è¦çš„ prop drillingï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ•´ç†æˆ‘ä»¬çš„è®¸å¤šç»„ä»¶ã€‚
*   **ä¸å†æœ‰ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“:**å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä»…ä»…å……å½“é“å…·ä¼ é€’å™¨çš„ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿé¿å…äº†é‚£äº›ç»„ä»¶çš„ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚å½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œåªæœ‰ä½¿ç”¨ä¸€éƒ¨åˆ†å…¨å±€çŠ¶æ€çš„ç»„ä»¶æ‰é‡æ–°å‘ˆç°ï¼Œè¿™æ˜¯æ‰€æœŸæœ›çš„è¡Œä¸ºã€‚

## ä½ å°†åœ¨è¿™é‡Œå­¦åˆ°ä»€ä¹ˆ

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•è®¾ç½®è‡ªå·±çš„ Redux-powered React åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª react åº”ç”¨ç¨‹åºï¼Œå¹¶è®¾ç½® redux æ¥å…¨å±€ç®¡ç†çŠ¶æ€ï¼Œä»¥ä¾¿ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥è®¿é—®çŠ¶æ€çš„ä»»ä½•éƒ¨åˆ†(å› æ­¤å‘½åä¸º redux powered react app)ã€‚å¯ä»¥å°è¯•çš„ redux çš„å…¶ä»–é€‰æ‹©æœ‰ MobXã€Zustand ç­‰ï¼Œä½†æ˜¯å¯¹äºæœ¬æ–‡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ reduxã€‚

æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åˆ›å»ºå•†åº—å¹¶å°†å…¶è¿æ¥åˆ°åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬è¿˜å°†çœ‹åˆ°å¦‚ä½•ç¼–å†™åŠ¨ä½œå¹¶åœ¨ç”¨æˆ·äº¤äº’æ—¶åˆ†æ´¾å®ƒä»¬ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åˆ¶ä½œ reducers å’Œæ›´æ–°å•†åº—ï¼Œä» App çš„å…¶ä»–å­ç»„ä»¶è¯»å–å•†åº—ï¼Œç­‰ç­‰ã€‚

æˆ‘è¿˜å°†æä¾›æ‰€æœ‰é‡è¦çš„ä»£ç ç‰‡æ®µï¼Œä»¥ä¾¿æ‚¨åœ¨é˜…è¯»å’Œç¼–å†™ä»£ç æ—¶èƒ½å¤Ÿå¿«é€Ÿå¯åŠ¨åº”ç”¨ç¨‹åºã€‚

ä¸ºäº†è®©æ‚¨åœ¨å¼€å§‹æ—¶æœ‰æ‰€äº†è§£ï¼Œè¿™æ˜¯æˆ‘ä»¬å°†åœ¨ç»“æŸæ—¶æ„å»ºçš„å†…å®¹:

![finalAppDemo](img/087429d2af4b437e7e6b767910102931.png)

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å’Œåˆ é™¤è´­ç‰©è½¦ä¸­çš„é¡¹ç›®ã€‚æˆ‘ä»¬å°†ç®¡ç† Redux å­˜å‚¨ä¸­çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶åœ¨ UI ä¸­æ˜¾ç¤ºä¿¡æ¯ã€‚

## å¼€å§‹ä¹‹å‰

åœ¨ç»§ç»­å­¦ä¹ æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œæ‚¨åº”è¯¥ç†Ÿæ‚‰ Redux å­˜å‚¨ã€æ“ä½œå’Œ reducersã€‚

å¦‚æœä½ ä¸æ˜¯ï¼Œå¯ä»¥ç¿»ç¿»æˆ‘ä¸Šä¸€ç¯‡å†™åœ¨ Redux ä¸Šçš„æ–‡ç« (å¦‚æœä½ è¿˜æ²¡æœ‰):**[Redux æ˜¯ä»€ä¹ˆï¼Ÿä¸ºåˆå­¦è€…è®²è§£çš„å­˜å‚¨ã€åŠ¨ä½œå’Œå‡é€Ÿå™¨](https://www.freecodecamp.org/news/what-is-redux-store-actions-reducers-explained/)ã€‚**

è¿™å°†æœ‰åŠ©äºä½ ç†è§£å½“å‰çš„æ–‡ç« ã€‚åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘è¯•å›¾è§£é‡Š Redux çš„åŸºæœ¬åŸç†/æ¦‚å¿µã€‚æˆ‘ä»‹ç»äº†ä»€ä¹ˆæ˜¯å•†åº—ï¼Œä»€ä¹ˆæ˜¯è¡ŒåŠ¨ï¼Œä»¥åŠå‡é€Ÿå™¨å¦‚ä½•å·¥ä½œã€‚æˆ‘è¿˜è®¨è®ºäº† Redux çš„å¯é¢„æµ‹æ€§ï¼Œå¹¶ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­ã€‚

![despicable-me-minions](img/d7417fefe109d4cb5b20c127a9ff49f9.png)

## åˆå§‹ä»£ç è®¾ç½®

è®©æˆ‘ä»¬å‡†å¤‡å¥½é¡¹ç›®æ‰€éœ€çš„ä¸€åˆ‡ã€‚åªè¦éµå¾ªè¿™äº›æ­¥éª¤ï¼Œæ‚¨å¾ˆå¿«å°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚

### 1.ä½¿ç”¨ create-react-app å‘½ä»¤åˆ›å»º React åº”ç”¨ç¨‹åº

```
npx create-react-app react-app-with-redux 
```

### 2.è½¬åˆ°æ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹

åªéœ€é”®å…¥ä»¥ä¸‹å‘½ä»¤å³å¯å¯¼èˆªåˆ°æ–°æ–‡ä»¶å¤¹:

```
cd react-app-with-redux 
```

### 3.å®‰è£… Redux å’Œ react-redux åº“

å¯ä»¥åƒè¿™æ ·å®‰è£… Redux å’Œ react-redux:

```
npm install redux react-redux 
```

### 4.è¿è¡Œåº”ç”¨ç¨‹åº

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œæ‚¨çš„æ–°åº”ç”¨ç¨‹åº:

```
npm start 
```

## å¦‚ä½•æ„å»ºä¸» App

### 5.å¦‚ä½•åˆ›å»ºå‡é€Ÿå™¨

è¦åˆ›å»ºä¸€ä¸ª reducerï¼Œé¦–å…ˆåœ¨`src`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`actionTypes`çš„æ–‡ä»¶å¤¹ã€‚ç„¶ååœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªåä¸º`actionTypes.js`çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å«åº”ç”¨ç¨‹åºå°†è¦å¤„ç†çš„æ‰€æœ‰**åŠ¨ä½œ**ã€‚

åœ¨`actionTypes.js`ä¸­å¢åŠ ä»¥ä¸‹å‡ è¡Œ:

```
export const ADD_ITEM = "ADD_ITEM";
export const DELETE_ITEM = "DELETE_ITEM"; 
```

ç”±äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†å…·æœ‰æ·»åŠ å’Œåˆ é™¤é¡¹ç›®çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸Šè¿°ä¸¤ç§æ“ä½œç±»å‹ã€‚

æ¥ä¸‹æ¥åœ¨`src`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`reducers`çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`cartReducer.js`çš„æ–°æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å°†åŒ…å«ä¸**æ¨è½¦**ç»„ä»¶ç›¸å…³çš„æ‰€æœ‰å‡é€Ÿå™¨é€»è¾‘ã€‚

**æ³¨æ„**:æˆ‘ä»¬å°†åœ¨æ­¥éª¤ 8 ä¸­åˆ›å»ºè§†å›¾/ç”¨æˆ·ç•Œé¢ï¼Œæ‰€ä»¥è¯·åšæŒã€‚

åœ¨`cartReducer.js`ä¸­å¢åŠ ä»¥ä¸‹å‡ è¡Œ:

```
import { ADD_ITEM, DELETE_ITEM } from "../actionTypes/actionTypes";

const initialState = {
  numOfItems: 0,
};

export default const cartReducer = (state = initialState, action) => {
  switch (action.type) {
    case ADD_ITEM:
      return {
        ...state,
        numOfItems: state.numOfItems + 1,
      };

    case DELETE_ITEM:
      return {
        ...state,
        numOfItems: state.numOfItems - 1,
      };
    default:
      return state;
  }
}; 
```

æ­£å¦‚æˆ‘ä»¬åœ¨æˆ‘ä¹‹å‰çš„æ•™ç¨‹ä¸­è®¨è®ºçš„[ï¼Œæˆ‘ä»¬ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ª**åˆå§‹çŠ¶æ€**ï¼Œå¹¶å°†å…¶åˆ†é…ç»™`cartReducer`å‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°`state`ã€‚](https://www.freecodecamp.org/news/what-is-redux-store-actions-reducers-explained/)

è¯¥åŠŸèƒ½å¼€å¯è°ƒåº¦çš„ç±»å‹çš„åŠ¨ä½œ**ã€‚ç„¶åï¼Œæ ¹æ®ä¸åŠ¨ä½œç±»å‹åŒ¹é…çš„å¤§å°å†™ï¼Œå¯¹çŠ¶æ€è¿›è¡Œå¿…è¦çš„æ›´æ”¹ï¼Œå¹¶è¿”å›æ›´æ–°çŠ¶æ€çš„æ–°å®ä¾‹ã€‚**

å¦‚æœæ²¡æœ‰ä¸€ä¸ªåŠ¨ä½œç±»å‹åŒ¹é…ï¼Œé‚£ä¹ˆçŠ¶æ€å°†åŸæ ·è¿”å›ã€‚

æœ€åï¼Œæˆ‘ä»¬ä¸º`cakeReducer`å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ª**é»˜è®¤å¯¼å‡º**ï¼Œä»¥ä¾¿åœ¨å•†åº—åˆ›å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨å®ƒã€‚

### 6.å¦‚ä½•åˆ›å»ºå•†åº—å¹¶å°†å…¶æä¾›ç»™åº”ç”¨ç¨‹åº

åœ¨`src`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`store.js`çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºå­˜å‚¨:

```
const store = createStore() 
```

åœ¨`store.js`ä¸­å¢åŠ ä»¥ä¸‹å‡ è¡Œ:

```
import { createStore } from "redux";
import { cartReducer } from "./reducers/cartReducer";

const store = createStore(cartReducer);

export default store; 
```

ç°åœ¨æ˜¯æ—¶å€™å°†è¿™ä¸ª`store`æä¾›ç»™`App`ç»„ä»¶äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»`react-redux`åº“ä¸­è·å¾—çš„`<Provider>`æ ‡ç­¾ã€‚

æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹è¯­æ³•å°†æ•´ä¸ª`App`ç»„ä»¶åŒ…è£…åœ¨`<Provider>`æ ‡ç­¾ä¸­:

```
// rest of the code ...

<Provider store={store}>
        <div>App Component</div>
        // child components of App/ other logic
</Provider>

// rest of the code ... 
```

é€šè¿‡å°†`App`ç»„ä»¶åŒ…è£…åœ¨`<Provider>`æ ‡ç­¾ä¸­ï¼Œ`App`çš„æ‰€æœ‰å­ç»„ä»¶éƒ½å¯ä»¥è®¿é—®`store`ã€‚ä½ å¯ä»¥çœ‹çœ‹æˆ‘ä¹‹å‰å†™çš„å…³äº[ä»€ä¹ˆæ˜¯ Redux çš„æ–‡ç« ï¼Ÿä¸ºåˆå­¦è€…è®²è§£çš„å­˜å‚¨ã€åŠ¨ä½œã€å‡é€Ÿå™¨](https://www.freecodecamp.org/news/what-is-redux-store-actions-reducers-explained/)äº†è§£æ›´å¤šã€‚

ç»§ç»­`App.js`ï¼Œå°†ä»¥ä¸‹å‡ è¡Œæ·»åŠ åˆ°æ–‡ä»¶ä¸­:

```
import "./App.css";
import { Provider } from "react-redux";
import store from "./store";

function App() {
  return (
    <Provider store={store}>
      <div>App Component</div>
    </Provider>
  );
}

export default App; 
```

### 7.åˆ›å»ºè¡ŒåŠ¨

ç°åœ¨åœ¨`src`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`actions`çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`cartAction.js`çš„æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€äº›ç”¨æˆ·äº¤äº’ä¸­éœ€è¦**åˆ†æ´¾**çš„æ‰€æœ‰åŠ¨ä½œã€‚

åœ¨`cartAction.js`ä¸­æ·»åŠ ä»¥ä¸‹å‡ è¡Œ:

```
import { ADD_ITEM, DELETE_ITEM } from "../actionTypes/actionTypes";

const addItem = () => {
  return {
    type: ADD_ITEM,
  };
};

const deleteItem = () => {
  return {
    type: DELETE_ITEM,
  };
};

export { addItem, deleteItem }; 
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªåŠ¨ä½œåˆ›å»ºå™¨(è¿”å›`action`å¯¹è±¡çš„çº¯ JS å‡½æ•°)ï¼Œåˆ†åˆ«å«åš`addItem()`å’Œ`deleteItem()`ã€‚ä¸¤ä¸ªåŠ¨ä½œåˆ›å»ºè€…éƒ½è¿”å›å¸¦æœ‰ç‰¹å®š`type`çš„`action`å¯¹è±¡ã€‚

**æ³¨æ„**:æ¯ä¸ª`action`å¯¹è±¡å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„`type`å€¼ã€‚ä¸æ­¤åŒæ—¶ï¼Œé€šè¿‡åŠ¨ä½œå¯¹è±¡ä¼ é€’çš„ä»»ä½•é™„åŠ æ•°æ®éƒ½æ˜¯å¯é€‰çš„ï¼Œå¹¶ä¸”å°†å–å†³äºç”¨äºæ›´æ–°`state`çš„é€»è¾‘

### 8.å¦‚ä½•åˆ›å»ºè§†å›¾/ç”¨æˆ·ç•Œé¢

æ—¢ç„¶æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æ‰€æœ‰å¿…éœ€çš„å®ä½“ï¼Œæ¯”å¦‚ storeã€actions å’Œ Reducersï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™åˆ›å»º UI å…ƒç´ äº†ã€‚

åœ¨`src`ä¸­åˆ›å»ºä¸€ä¸ª`component`æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª`Cart.js`æ–‡ä»¶ã€‚åœ¨`Cart.js`ä¸­æ·»åŠ ä»¥ä¸‹å‡ è¡Œ:

```
import React from "react";

const Cart = () => {
  return (
    <div className="cart">
      <h2>Number of items in Cart:</h2>
      <button className="green">Add Item to Cart</button>
      <button className="red">Remove Item from Cart</button>
    </div>
  );
};

export default Cart; 
```

å°†æ­¤`Cart`ç»„ä»¶æ·»åŠ åˆ°`App.js`æ–‡ä»¶ä¸­:

```
import "./App.css";
import { Provider } from "react-redux";
import store from "./store";
import Cart from "./component/Cart";

function App() {
  return (
    <Provider store={store}>
      <Cart />
    </Provider>
  );
}

export default App; 
```

ä¸ºäº†è®©å®ƒçœ‹èµ·æ¥æ›´åƒæ ·ï¼Œæˆ‘åœ¨`App.css`ä¸­æ·»åŠ äº†ä¸€äº›åŸºæœ¬çš„æ ·å¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
button {
  margin: 10px;
  font-size: 16px;
  letter-spacing: 2px;
  font-weight: 400;
  color: #fff;
  padding: 23px 50px;
  text-align: center;
  display: inline-block;
  text-decoration: none;
  border: 0px;
  cursor: pointer;
}
.green {
  background-color: rgb(6, 172, 0);
}
.red {
  background-color: rgb(221, 52, 66);
}
.red:disabled {
  background-color: rgb(193, 191, 191);
  cursor: not-allowed;
}
.cart {
  text-align: center;
} 
```

è¿™æ˜¯ç›®å‰ä¸ºæ­¢ç”¨æˆ·ç•Œé¢çš„å¤–è§‚:

![Screenshot-2022-05-20-at-20.01.01](img/94a5b7e901a3f9cdd9355ec2e16b3b9b.png)

### 9.å¦‚ä½•ä½¿ç”¨`useSelector`é’©å­è¯»å–å’Œè®¿é—®å­˜å‚¨

`useSelector`æ˜¯ç”± **react-redux** åº“æä¾›çš„ä¸€ä¸ªé’©å­ï¼Œå¸®åŠ©æˆ‘ä»¬è¯»å–`store`åŠå…¶å†…å®¹ã€‚

ä»`react-redux`å¯¼å…¥æŒ‚é’©ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹è¯­æ³•è¯»å–å¸¦æœ‰`useSelector`æŒ‚é’©çš„å­˜å‚¨:

```
import { useSelector } from "react-redux";
// rest of the code
const state = useSelector((state) => state);

// rest of the code 
```

æ·»åŠ äº†`useSelector`æŒ‚é’©åï¼Œæ‚¨çš„`Cart.js`æ–‡ä»¶å°†å¦‚ä¸‹æ‰€ç¤º:

```
import React from "react";
import { useSelector } from "react-redux";

const Cart = () => {
  const state = useSelector((state) => state);
  console.log("store", state);
  return (
    <div className="cart">
      <h2>Number of items in Cart:</h2>
      <button className="green">Add Item to Cart</button>
      <button className="red">Remove Item from Cart</button>
    </div>
  );
};

export default Cart; 
```

æ§åˆ¶å°è®°å½•çŠ¶æ€å°†ä¸ºæˆ‘ä»¬æä¾›åœ¨æ­¥éª¤ 5 ä¸­åœ¨ reducer æ–‡ä»¶ä¸­è®¾ç½®çš„åˆå§‹çŠ¶æ€ã€‚

![Screenshot-2022-05-21-at-01.10.28](img/14a994968e570267a7c05253eed4534a.png)

### 10.å¦‚ä½•ç”¨`useDispatch`é’©å­è°ƒåº¦ä¸€ä¸ªç‚¹å‡»æŒ‰é’®çš„åŠ¨ä½œ

react-redux åº“ç»™äº†æˆ‘ä»¬å¦ä¸€ä¸ªé’©å­ï¼Œå«åš`useDispatch`é’©å­ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬åˆ†æ´¾åŠ¨ä½œæˆ–åŠ¨ä½œåˆ›å»ºè€…ï¼Œç„¶åè¿”å›åŠ¨ä½œã€‚è¯­æ³•å¦‚ä¸‹:

```
const dispatch = useDispatch();

dispatch(actionObject or calling the action creator); 
```

å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„`Cart.js`ä¸­æ·»åŠ ä¸€ä¸ªè°ƒåº¦ç¨‹åºå°†æœ€ç»ˆä½¿æ–‡ä»¶çœ‹èµ·æ¥åƒè¿™æ ·:

```
import React from "react";
import { useSelector, useDispatch } from "react-redux";
import { addItem, deleteItem } from "../actions/cartAction";

const Cart = () => {
  const state = useSelector((state) => state);
  const dispatch = useDispatch();
  return (
    <div className="cart">
      <h2>Number of items in Cart: {state.numOfItems}</h2>
      <button
        onClick={() => {
          dispatch(addItem());
        }}
      >
        Add Item to Cart
      </button>
      <button
        disabled={state.numOfItems > 0 ? false : true}
        onClick={() => {
          dispatch(deleteItem());
        }}
      >
        Remove Item to Cart
      </button>
    </div>
  );
};

export default Cart; 
```

æ³¨æ„å¦‚ä½•ç‚¹å‡»**æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦**æŒ‰é’®ï¼Œæˆ‘ä»¬`dispatch`åœ¨ç¬¬ 7 æ­¥ä¸­åˆ›å»ºçš„åŠ¨ä½œåˆ›å»ºè€…`addItem()`ã€‚

ç±»ä¼¼åœ°ï¼Œåœ¨ç‚¹å‡»**ä»è´­ç‰©è½¦ä¸­ç§»é™¤å•†å“**æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬ç”¨`deleteItem()`åˆ†æ´¾åŠ¨ä½œåˆ›å»ºè€…ã€‚

`state`å˜é‡å­˜å‚¨åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰é”®`numOfItems`çš„å¯¹è±¡ã€‚æ‰€ä»¥`state.numOfItems`ç»™å‡ºäº†å•†åº—ä¸­å½“å‰çš„å•†å“æ•°é‡å€¼ã€‚

æˆ‘ä»¬åœ¨è§†å›¾çš„ç¬¬`<h2>Number of items in Cart: {state.numOfItems}</h2>`è¡Œæ˜¾ç¤ºè¿™äº›ä¿¡æ¯ã€‚

æ›´æ·±å…¥åœ°è¯´ï¼Œå½“ç”¨æˆ·å•å‡» Add Item to Cart æŒ‰é’®æ—¶ï¼Œå®ƒä¼šè°ƒåº¦`addItem()` action creatorã€‚è¿™åˆè¿”å›äº†ä¸€ä¸ªç±»å‹ä¸º`type: ADD_ITEM`çš„`action`å¯¹è±¡ã€‚

æ­£å¦‚æˆ‘åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­æåˆ°çš„ï¼Œå½“ä¸€ä¸ªåŠ¨ä½œè¢«åˆ†æ´¾æ—¶ï¼Œæ‰€æœ‰çš„ reducers éƒ½è¢«æ¿€æ´»ã€‚

ç›®å‰ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªå‡é€Ÿå™¨â€”`cartReducer`ã€‚å› æ­¤å®ƒå˜å¾—æ´»è·ƒå¹¶ç›‘å¬è¢«åˆ†æ´¾çš„`action`ã€‚

å¦‚æ­¥éª¤ 5 æ‰€ç¤ºï¼Œreducer å°†çŠ¶æ€å’ŒåŠ¨ä½œä½œä¸ºè¾“å…¥ï¼Œæ‰“å¼€`action type`ï¼Œ**è¿”å›æ›´æ–°çŠ¶æ€**çš„æ–°å®ä¾‹ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“å¸¦æœ‰`type: ADD_ITEM`çš„åŠ¨ä½œä¸ç¬¬ä¸€ä¸ªå¼€å…³åŒ¹é…æ—¶ï¼Œå®ƒé¦–å…ˆä½¿ç”¨æ‰©å±•æ“ä½œç¬¦`...state`å¤åˆ¶æ•´ä¸ªçŠ¶æ€ã€‚ç„¶åå®ƒè¿›è¡Œå¿…è¦çš„æ›´æ–°â€”â€”åœ¨æ·»åŠ é¡¹ç›®çš„æƒ…å†µä¸‹æ˜¯`numOfItems: state.numOfItems + 1`(å³å°†`numOfItems`åŠ  1)ã€‚

ç±»ä¼¼åœ°ï¼Œä½¿ç”¨ç›¸åŒçš„é€»è¾‘ï¼Œåœ¨ç‚¹å‡»ä»è´­ç‰©è½¦ä¸­ç§»é™¤å•†å“æŒ‰é’®æ—¶ï¼Œç±»å‹ä¸º`type: DELETE_ITEM`çš„åŠ¨ä½œè¢«åˆ†æ´¾ï¼Œè¯¥åŠ¨ä½œå°†`numOfItems`å‡ 1ã€‚

è¿™æ˜¯å·¥ä½œåº”ç”¨ç¨‹åºçš„æ¼”ç¤º:

![finalAppDemo-1](img/29dcb5808c03c55d95563b18efd33579.png)

æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•æ ¹æ® Redux store ä¸­çš„å€¼`numOfItems`æ¥æ§åˆ¶ä»è´­ç‰©è½¦ä¸­ç§»é™¤å•†å“æŒ‰é’®çš„è¡Œä¸ºçš„ã€‚ç”±äºè´Ÿçš„å•†å“æ•°é‡æ²¡æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬ç¦ç”¨äº†ä»è´­ç‰©è½¦ä¸­ç§»é™¤å•†å“æŒ‰é’®ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé˜²æ­¢ç”¨æˆ·å‡å°‘è´­ç‰©è½¦ä¸­å·²ç»æ˜¯ 0 çš„å•†å“æ•°é‡ã€‚

è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼Œå‘æ‚¨å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•åŸºäºåº”ç”¨ç¨‹åºçš„å†…éƒ¨çŠ¶æ€æ¥æ§åˆ¶å„ç§ DOM å…ƒç´ çš„è¡Œä¸ºã€‚

è¿™å°±å¯¹äº†ã€‚æˆ‘ä»¬åˆšåˆšå®Œæˆäº†ç¬¬ä¸€ä¸ªåŸºäº Redux çš„ React åº”ç”¨ç¨‹åºçš„è®¾ç½®ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„éœ€æ±‚åˆ›å»ºå„ç§å…¶ä»–ç»„ä»¶ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´å…±äº«ä¸€ä¸ªé€šç”¨çš„å…¨å±€çŠ¶æ€ã€‚

## GitHub å›è´­

è¿™æ˜¯è¯¥é¡¹ç›®çš„ GitHub repoï¼Œå¦‚æœä½ æ„¿æ„ï¼Œå¯ä»¥æŸ¥çœ‹å®Œæ•´çš„æºä»£ç : [GitHub repo](https://github.com/sohamderoy/blog-setup-react-app-with-redux/tree/master)

## æ‘˜è¦

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å¿«é€Ÿå¯åŠ¨åŸºäº Redux çš„ React åº”ç”¨ç¨‹åºã€‚

ä¸€è·¯èµ°æ¥ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•:

*   åˆ›å»ºè¡ŒåŠ¨ã€è¡ŒåŠ¨åˆ›å»ºè€…ã€ç¼©å‡è€…å’Œå•†åº—
*   ä½¿ç”¨`<Provider>`å‘åº”ç”¨ç¨‹åºæä¾›å•†åº—
*   ä½¿ç”¨`useSelector`é’©å­ä»ç»„ä»¶ä¸­è¯»å–/è®¿é—®å­˜å‚¨ï¼Œå¹¶åœ¨ UI ä¸­æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
*   ä½¿ç”¨`useDispatch`é’©å­è°ƒåº¦ç”¨æˆ·äº‹ä»¶ä¸Šçš„åŠ¨ä½œï¼Œæ¯”å¦‚æŒ‰é’®ç‚¹å‡»
*   åŸºäºåº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œç”¨é€»è¾‘æ§åˆ¶ DOM å…ƒç´ çš„è¡Œä¸º
*   æˆ‘ä»¬äº†è§£äº†ä½æ•ˆçš„çŠ¶æ€ç®¡ç†å’Œå¤šçº§æ”¯æŸ±é’»æ¢çš„ç¼ºç‚¹

## é¢å¤–èµ„æº

è¿™é‡Œæœ‰ä¸€äº›é¢å¤–çš„èµ„æºï¼Œä½ å¯ä»¥çœ‹çœ‹ï¼Œä»¥äº†è§£æ›´å¤šå…³äº Redux

*   [Redux æ˜¯ä»€ä¹ˆï¼Ÿä¸ºåˆå­¦è€…è§£é‡Šçš„å­˜å‚¨ã€åŠ¨ä½œå’Œå‡é€Ÿå™¨](https://www.freecodecamp.org/news/what-is-redux-store-actions-reducers-explained/)
*   [å®˜æ–¹å†—ä½™æ–‡ä»¶](https://redux.js.org/introduction/getting-started)

## åŒ…æ‰

æ„Ÿè°¢é˜…è¯»ï¼æˆ‘çœŸçš„å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»å…³äºå¦‚ä½•å¯åŠ¨ Redux-powered React åº”ç”¨ç¨‹åºçš„æ–‡ç« ï¼Œå¹¶ä¸”è§‰å¾—è¿™ç¯‡æ•™ç¨‹å¾ˆæœ‰ç”¨ã€‚

è¯·è€ƒè™‘ä¸ä½ çš„æœ‹å‹åˆ†äº«ï¼Œå› ä¸ºæˆ‘çœŸçš„å¾ˆæ„Ÿæ¿€ã€‚åœ¨ LinkedIn å’Œ Twitter ä¸Šå…³æ³¨æˆ‘ï¼Œå…³æ³¨æ›´å¤šç²¾å½©å†…å®¹ï¼å®‰é™ç‚¹ã€‚ğŸ––

### ç¤¾ä¼šè”ç³»

*   [LinkedIn](https://www.linkedin.com/feed/)
*   [ç½‘ç«™](https://www.sohamderoy.dev/)
*   [æˆ‘çš„å…¶ä»–åšå®¢](https://blogs.sohamderoy.dev)
*   [æ¨ç‰¹](https://twitter.com/_sohamderoy)