# å¼€å§‹ä½¿ç”¨ next . jsâ€”â€”æ‚¨çš„é¡¹ç›®éœ€è¦çš„ React åº“

> åŸæ–‡ï¼š<https://www.freecodecamp.org/news/nextjs-tutorial/>

æˆ‘æ’°å†™æœ¬æŒ‡å—æ˜¯ä¸ºäº†ç»™ä½ ä¸€ä¸ªå®ç”¨çš„æ¦‚è¿°ï¼Œä¹Ÿè®¸æ˜¯ä½ å°†ç”¨æ¥æ„å»º 90%çš„é¡¹ç›®çš„æœ€é‡è¦çš„ React åº“:Next.jsã€‚

æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯è®©ä½ å°½å¯èƒ½å®¹æ˜“åœ°å¼€å§‹ä½¿ç”¨ Next.jsã€‚

è¿™ä¸æ˜¯å…³äº Next çš„å®Œæ•´æŒ‡å—ï¼Œä½†å®ƒå°†ä¸ºæ‚¨æä¾›æ‚¨éœ€è¦äº†è§£çš„ä¸€åˆ‡:

*   ä»€ä¹ˆæ˜¯ Next.js(ä»¥åŠä¸ºä»€ä¹ˆæ‚¨åº”è¯¥å¼€å§‹åœ¨ React é¡¹ç›®ä¸­ä½¿ç”¨å®ƒ)
*   å¦‚ä½•ä½¿ç”¨ Next.js æ‰§è¡ŒåŸºæœ¬ä»»åŠ¡
*   ä»¥åŠ Next.js å°†å¦‚ä½•å¸®åŠ©æ‚¨æ›´å¿«åœ°æ„å»ºæ€»ä½“ä¸Šæ›´å¥½çš„ React åº”ç”¨ç¨‹åº

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

> æˆ‘å·²ç»å¸®åŠ©äº† 100 å¤šäººä»å®Œå…¨çš„åˆå­¦è€…åˆ°å—é›‡çš„ React å¼€å‘äººå‘˜ã€‚æƒ³åšåŒæ ·çš„äº‹å—ï¼ŸæŸ¥çœ‹ [****The React è®­ç»ƒè¥****](https://reactbootcamp.com/) ã€‚

## ç›®å½•

*   [next . js æ˜¯ä»€ä¹ˆï¼Ÿ](#what-is-next-js)
*   [next . js ç»™äº†ä½ ä»€ä¹ˆç‰¹æ€§](#what-features-next-js-gives-you)
*   [next . js æ²¡æœ‰çš„åŠŸèƒ½æœ‰å“ªäº›](#what-features-next-js-doesn-t-have)
*   [å¦‚ä½•åˆ›å»º Next.js App](#how-to-create-a-next-js-app)
*   [Next.js è„šæœ¬](#next-js-scripts)
*   [æ·»åŠ  TypeScript åˆ° Next.js](#add-typescript-to-next-js)
*   [é¡µé¢å’Œè·¯çº¿](#pages-and-routes)
*   [é“¾æ¥å’Œå¯¼èˆª](#links-and-navigation)
*   [next . js ä¸­çš„ SEO](#seo-in-next-js)
*   [API è·¯çº¿](#api-routes)
*   [è¯·æ±‚æ•°æ®å®¢æˆ·ç«¯](#request-data-client-side)
*   [è¯·æ±‚æ•°æ®æœåŠ¡å™¨ç«¯](#request-data-server-side)
*   [GetServerSideProps](#getserversideprops)
*   [GetStaticProps](#getstaticprops)
*   [ä¸‹ä¸€æ­¥å»å“ªé‡Œå­¦. js](#where-to-learn-next-js)

## Next.js æ˜¯ä»€ä¹ˆï¼Ÿ

æ¯«æ— ç–‘é—®ï¼Œä»»ä½• React å¼€å‘äººå‘˜å­¦ä¹ å’Œæ”¹è¿›ä»–ä»¬è‡ªå·±çš„é¡¹ç›®çš„æœ€ç»ˆå·¥å…·æ˜¯ **Next.js** ã€‚

![Screen-Shot-2022-01-14-at-12.12.20-PM](img/24d82ad1679232138c6400483debc3e6.png)

The NextJS.org Homepage

æ— è®ºæˆ‘æ˜¯åœ¨å»ºç«‹ä¸€ä¸ªåƒåšå®¢ä¸€æ ·çš„å…·æœ‰äº¤äº’æ€§çš„é™æ€ç½‘ç«™ï¼Œè¿˜æ˜¯ä¸€ä¸ªåƒç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºä¸€æ ·çš„é«˜åº¦åŠ¨æ€çš„å…¨æ ˆé¡¹ç›®ï¼Œ*æˆ‘å‡ ä¹æ€»æ˜¯åœ¨å¯»æ‰¾ä¸‹ä¸€ä¸ª*ã€‚

ä½ ä½¿ç”¨ Next çš„ç¬¬ä¸€ä¸ªåŸå› æ˜¯ï¼Œæ­£å¦‚æ ‡é¢˜æ‰€è¯´ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª **React æ¡†æ¶**ã€‚

å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ç§â€œå†…ç½®ç”µæ± â€çš„æ–¹å¼æ¥æ„å»º React åº”ç”¨ç¨‹åºï¼Œå®ƒç»™ä½ å¸¦æ¥äº† Create React App ç­‰å·¥å…·çš„ç®€å•æ€§ï¼Œå¹¶ç»“åˆäº†ä¸€å¥—å…¶ä»–è¶…çº§å¼ºå¤§çš„åŠŸèƒ½ã€‚

å°½ç®¡æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼ŒNext.js ä¿ç•™äº†ä¸€äº›éä¸ªäººåŒ–çš„ React å“²å­¦ã€‚Next ä¸ºæ‚¨æä¾›äº†æ”¹è¿›æ•´ä½“å¼€å‘ä½“éªŒçš„ç‰¹æ€§ï¼Œä½†å¹¶æ²¡æœ‰é™åˆ¶æ‚¨å¯ä»¥é€‰æ‹©çš„é€‰é¡¹æ•°é‡ã€‚

äº‹å®ä¸Šï¼Œè€ƒè™‘åˆ° Next è®© React åº”ç”¨æˆä¸ºå¯èƒ½ï¼Œæˆ‘è®¤ä¸ºå®ƒçœŸçš„æ‰©å¤§äº†ä½ å¯ç”¨çš„é€‰é¡¹æ•°é‡ï¼Œå¦‚æœä½ éœ€è¦çš„è¯ã€‚

é€šè¿‡æŸ¥çœ‹ä½äº[nextjs.org/examples](https://nextjs.org/examples)çš„ 100 ä¸ª Next.js é¡¹ç›®ç¤ºä¾‹ï¼Œä½ å¯ä»¥æ›´å…¨é¢åœ°äº†è§£ Next.js åº”ç”¨ç¨‹åºçš„èƒ½åŠ›:

![Screen-Shot-2022-01-14-at-1.56.57-PM](img/3ee3ee17f489b4218d847376a5526ae6.png)

Next.js Examples

åœ¨é‚£é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¦‚ä½•åˆ›å»ºä»¥ä¸‹ Next (React)åº”ç”¨ç¨‹åºçš„ç¤ºä¾‹:

*   ä½¿ç”¨ Markdown / MDX æˆ– Wordpress çš„åšå®¢
*   ä½¿ç”¨ Shopify çš„ç”µå­å•†åŠ¡åº”ç”¨ç¨‹åº
*   ä½¿ç”¨ Contentful æˆ– Sanity ç­‰å†…å®¹ç®¡ç†ç³»ç»Ÿçš„ç½‘ç«™
*   å¸¦æœ‰ GraphQL å’Œèº«ä»½éªŒè¯çš„å…¨æ ˆé¡¹ç›®

è¿˜æœ‰æ›´å¤šï¼ä¸€å®šè¦æŸ¥çœ‹å®Œæ•´çš„åˆ—è¡¨ï¼Œæ¿€å‘ä½ çš„æƒ³è±¡åŠ›ã€‚

## Next.js ç»™äº†ä½ ä»€ä¹ˆç‰¹æ€§

ä¸‹é¢æ˜¯ Next ç»™ä½ çš„ React é¡¹ç›®çš„æ¸…å•ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå®ƒåœ¨ä¸€ä¸ª`next`ä¾èµ–é¡¹ä¸­æä¾›äº†ä¸€æ•´å¥—åŒ…çš„åŠŸèƒ½ã€‚

Next.js ç»™ä½ :

*   åŸºäºé¡µé¢çš„è·¯ç”±(é€šè¿‡å°†ç»„ä»¶æ”¾å…¥/pages æ¥åˆ›å»ºé¡µé¢)
*   å†…ç½®è·¯ç”±å™¨(æ— éœ€å®‰è£… React è·¯ç”±å™¨)
*   API è·¯ç”±(ä½¿ç”¨/pages/api ä¸­çš„ Node.js ç¼–å†™åç«¯ä»£ç )
*   ç”¨äºå¼€å‘/ç”Ÿäº§çš„è¶…å¿«é€Ÿæ„å»º(å³æ—¶æŸ¥çœ‹ä¿å­˜çš„æ›´æ”¹)
*   å›¾åƒå’Œå­—ä½“ä¼˜åŒ–
*   å†…ç½®çš„ ESLint å’Œ TypeScript æ”¯æŒ
*   +å¨ä»¥ä¸Š(å…¨éƒ¨åœ¨ [Next.js æ–‡æ¡£](https://nextjs.org/docs/)ä¸­æ¦‚è¿°)

## Next.js æ²¡æœ‰çš„åŠŸèƒ½æœ‰å“ªäº›

æ­¤å¤–ï¼Œè¿˜æœ‰è®¸å¤š Next.js æ²¡æœ‰æä¾›çš„åŸºæœ¬åŠŸèƒ½ã€‚

ä¾‹å¦‚ï¼Œåœ¨ Next ä¸­æ²¡æœ‰å†…ç½®çš„æ–¹æ³•æ¥æ‰§è¡Œä»¥ä¸‹æ“ä½œ:

*   è®¤è¯(æˆ‘æ¨èä½¿ç”¨åŒ… Next-Auth)
*   æµ‹è¯•(æˆ‘æ¨èä½¿ç”¨å‰§ä½œå®¶æˆ–èµ›æ™®æ‹‰æ–¯è¿›è¡Œ E2E æµ‹è¯•)
*   çŠ¶æ€ç®¡ç†(æˆ‘æ¨è Zustand æˆ–è€… Redux å·¥å…·åŒ…)

[æ–‡æ¡£æœ¬èº«](https://nextjs.org/docs/authentication)æ¶µç›–äº†è¿™äº›ç¼ºç‚¹ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ Next.js ä¸ºæ‚¨æä¾›äº†å¤§é‡çš„**ï¼Œä½†å®ƒä¸ä¼šå•ç‹¬æ¶µç›–æ¯ä¸ªåº”ç”¨ç”¨ä¾‹**ã€‚

## Next.js SpeedrunğŸ’¨

æˆ‘å°†å‘æ‚¨å±•ç¤º Next.js çš„äº®ç‚¹ï¼Œè®©æ‚¨äº†è§£è¯¥æ¡†æ¶å¦‚ä½•ä¸ºæ‚¨æä¾›è®©æ‚¨æ›´é«˜æ•ˆçš„é»˜è®¤è®¾ç½®ã€‚

## å¦‚ä½•åˆ›å»º Next.js åº”ç”¨ç¨‹åº

å¦‚æœæ‚¨å®‰è£…äº† NPMï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä»»ä½•æ–°çš„ä¸‹ä¸€ä¸ªé¡¹ç›®:

```
npx create-next-app my-next-project
```

`create-next-app`æ˜¯ä¸€ä¸ªç±»ä¼¼ Create React App çš„åŒ…ï¼Œä½†æ˜¯é’ˆå¯¹ Next.js é¡¹ç›®ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®‰è£…äº†æ‰€æœ‰ä¾èµ–é¡¹(åˆ†åˆ«æ˜¯`next`ã€`react`å’Œ`react-dom`)çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼Œå¤–åŠ ä¸€äº›è™šæ‹Ÿé¡µé¢å’Œæ ·å¼ã€‚

## Next.js è„šæœ¬

æ‚¨ç›®å‰ä¼šå‘ç°åœ¨æ‚¨çš„`package.json`æ–‡ä»¶ä¸­åˆ—å‡ºäº†å››ä¸ªä¸»è¦è„šæœ¬:

```
"scripts": {
  "dev": "next dev",
  "build": "next build",
  "start": "next start",
  "lint": "next lint"
}
```

*   `dev`â€“åœ¨ localhost:3000 ä¸Šè¿è¡Œå¼€å‘æœåŠ¡å™¨
*   `build`â€“åˆ›å»ºä¸€ä¸ªå·²æ„å»ºå¥½çš„åº”ç”¨ç¨‹åºä»¥å¤‡éƒ¨ç½²
*   `start`â€“å¯åŠ¨æ‚¨æ„å»ºçš„ä¸‹ä¸€ä¸ªåº”ç”¨ç¨‹åº(å¿…é¡»å…ˆè¿è¡Œ`next build`
*   å¦‚æœä½ å†™çš„ä»£ç éœ€è¦ä¿®æ”¹ï¼Œå°†ä½¿ç”¨å¼€å‘ä¾èµ– ESLintâ€œlintâ€ä½ çš„ä¸‹ä¸€ä¸ªé¡¹ç›®æ¥è­¦å‘Šä½ 

è¦åœ¨å¼€å‘ä¸­è¿è¡Œæ‚¨çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ï¼Œè¯·ç¡®ä¿æ‚¨åœ¨æ‚¨çš„é¡¹ç›®æ–‡ä»¶å¤¹(my-next-project)ä¸­ï¼Œå¹¶è¿è¡Œå¼€å‘è„šæœ¬:

```
npm run dev
```

å½“æ‚¨çš„é¡¹ç›®åœ¨ localhost:3000 ä¸Šå¯åŠ¨å¹¶è¿è¡Œåï¼Œå¯¼èˆªåˆ°é‚£é‡Œï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªé»˜è®¤çš„åº”ç”¨ç¨‹åº:

![Screen-Shot-2022-01-14-at-2.41.23-PM](img/03ce894ab80cc3267915c478e233cd89.png)

Index page of Create-Next-App project

## å°† TypeScript æ·»åŠ åˆ° Next.js

æƒ³åŠ  TypeScriptï¼Ÿå†ç®€å•ä¸è¿‡äº†:

```
# run 'touch' to create an empty config file
# Next will auto-populate it

touch tsconfig.json 

# then you'll be prompted to run the command:
npm install -D typescript @types/react @types/node

# now you can use TypeScript everywhere âœ¨
```

## é¡µé¢å’Œè·¯çº¿

æƒ³åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­æ·»åŠ â€œå…³äºâ€é¡µé¢å—ï¼Ÿ

åªéœ€å°†ç»„ä»¶æ”¾å…¥/pages/about.js(ã€‚tsx å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ TypeScript):

```
// No React import needed up here! ğŸ˜³

export default function About() {
  return <div>About</div>
}
```

è€Œä¸”å¾ˆç®¡ç”¨ï¼

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†éœ€è¦å®‰è£…åƒ React Router è¿™æ ·çš„åº“ï¼Œå®ƒéœ€è¦è¯¸å¦‚ Router å’Œ Route ç»„ä»¶ç­‰æ ·æ¿æ–‡ä»¶ã€‚

å¦‚æœæ‚¨æƒ³è¦åŠ¨æ€é¡µé¢ï¼Œå®ƒä»¬åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯æœ‰ä¸åŒçš„ slugs(æ¯”å¦‚åšå®¢æ–‡ç« )ï¼ŒNext å…è®¸æˆ‘ä»¬é€šè¿‡å°†æ–‡ä»¶åæ”¾åœ¨æ‹¬å·ä¸­æ¥å‘ˆç°ç›¸åŒçš„é¡µé¢ç»„ä»¶ã€‚

ä¾‹å¦‚ï¼Œä¸ºäº†æ ¹æ®ç‰¹å®šçš„ slug æ˜¾ç¤ºåšå®¢æ–‡ç« ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ pages ä¸­æ”¾ç½®ä¸€ä¸ªâ€œblogâ€æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶åä¸º:[slug]ã€‚js:

```
import { useRouter } from 'next/router'

// if we navigate to localhost:3000/blog/123...
export default function BlogPost() {
  const router = useRouter()
  const { slug } = router.query

  return <p>Post: {slug}</p> // ...you'll see "Post: 123"
}
```

Next æ–¹ä¾¿åœ°å…¬å¼€äº†ä¸€ä¸ª`useRouter` React é’©å­ï¼Œä½¿å¾—è®¿é—®å…³äºåº”ç”¨ä½ç½®æˆ–å†å²çš„ä¿¡æ¯å˜å¾—éå¸¸å®¹æ˜“ã€‚

åœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»`router.query`è·å–æŸ¥è¯¢å‚æ•°(åŠ¨æ€å€¼)ã€‚å±æ€§å`slug`ä¸æˆ‘ä»¬ç»™æ–‡ä»¶çš„åŠ¨æ€å`[slug].js`ç›¸åŒ¹é…ã€‚

> æ³¨æ„:ç”±äºä½¿ç”¨å…·æœ‰åŠ¨æ€åç§°çš„åµŒå¥—æ–‡ä»¶å¤¹ï¼Œæ‚¨å¯ä»¥æœ‰å¤šä¸ªæŸ¥è¯¢å‚æ•°ã€‚å¦‚/blog/[topic]/[slug].js .ä»[slug]å†…éƒ¨ã€‚jsï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®`topic`å’Œ`slug`æŸ¥è¯¢å‚æ•°ã€‚

## é“¾æ¥å’Œå¯¼èˆª

å°±åƒ Next åŒ…æ‹¬ routes å’Œ routing ä¸€æ ·ï¼Œè¿™ä¸ªæ¡†æ¶ä¹Ÿä»`next/link`ä¸­ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœ‰ç”¨çš„`Link`ç»„ä»¶ã€‚

å¦‚æœæ‚¨æ¥è‡ª React Routerï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹ä¸å¯»å¸¸ï¼Œå› ä¸ºå®ƒéœ€è¦å°†ä¼ ç»Ÿçš„é”šæ ‡è®°é“¾æ¥ä½œä¸ºå­é“¾æ¥ï¼Œå¹¶å°† href ä½œä¸ºé“å…·ä¼ é€’ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è¦é“¾æ¥åˆ°ä¸»é¡µ(/)å’Œåšå®¢è·¯å¾„(å³/blog/123)ï¼Œæˆ‘ä»¬å°†åœ¨/pages/about.js ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹:

```
import Link from "next/link";

export default function About() {
  return (
    <div>
      <h1>About Me</h1>

      <div>
        <Link href="/">
          <a>Home</a>
        </Link>
        <Link href="/blog/123">
          <a>My Blog Post</a>
        </Link>
      </div>
    </div>
  );
} 
```

`href`æ˜¯`Link`ç»„ä»¶å”¯ä¸€éœ€è¦çš„å±æ€§ï¼Œæ•°æ®ä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ä¼ é€’ç»™å®ƒ:

```
import Link from "next/link";

export default function About() {
  return (
    <div>
      <h1>About Me</h1>

      <div>
        <Link href={{ pathname: "/about" }}>
          <a>Home</a>
        </Link>
        <Link
          href={{
            pathname: "/blog/[slug]",
            query: { slug: "123" },
          }}
        >
          <a>My Blog Post</a>
        </Link>
      </div>
    </div>
  );
} 
```

ä¹Ÿå¯ä»¥ä½¿ç”¨`useRouter`é’©å­æ¥æ”¹å˜è·¯çº¿ï¼Œä¸»è¦æ˜¯ä½¿ç”¨`.push()`æ–¹æ³•ä»¥ç¼–ç¨‹æ–¹å¼æ¨é€åˆ°ä¸åŒçš„è·¯çº¿ã€‚

è¿™æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢çš„è™šæ‹Ÿç¤ºä¾‹ï¼Œç”¨æˆ·æä¾›ä»–ä»¬çš„ç”µå­é‚®ä»¶è¿›è¡Œç™»å½•ï¼Œç„¶åè¢«æ¨é€åˆ°â€œ/verify-emailâ€è·¯å¾„ã€‚

```
export default function Login() {
  const router = useRouter()

  function onSubmit(event) {
    event.preventDefault();
    const email = event.target.elements.email.value;  
    await sendLoginEmail(email);    
    // push user to /verify-email page
    router.push('/verify-email');
  }

  return (
    <div>
      <h1>Log in here</h1>

      <form onSubmit={onSubmit}>
        <input name="email" placeholder="Your email address" />
        <button type="submit">Submit</button>
      </form>
    </div>
  );
}
```

## Next.js ä¸­çš„ SEO

web åº”ç”¨ç¨‹åºä¸­çš„é¡µé¢ä¸ä»…éœ€è¦ HTML ä¸»ä½“ä¸­çš„æ•°æ®ï¼Œè¿˜éœ€è¦ meta (head)æ ‡è®°ã€‚

åœ¨ Create React åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™éœ€è¦å®‰è£…ä¸€ä¸ªåä¸º React Helmet çš„å¤–éƒ¨ä¾èµ–é¡¹ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`next/head`ä¸­çš„`Head`ç»„ä»¶æ–¹ä¾¿åœ°å°†å…ƒæ•°æ®æ·»åŠ åˆ°æˆ‘ä»¬çš„ç½‘é¡µä¸­ï¼Œä»¥æ˜¾ç¤ºåœ¨æœç´¢ç»“æœä¸­ï¼Œå¹¶åµŒå…¥:

```
import Link from "next/link";
import Head from "next/head";

export default function About() {
  return (
    <div>
      <Head>
      	<title>About | My Cool Site</title>
        <meta name="description" content="You really need to read this website because it's made with Next.js" />
      </Head>

      <h1>About Me</h1>
      <div>
        <Link href="/">
          <a>Home</a>
        </Link>
        <Link href="/blog/123">
          <a>My Blog Post</a>
        </Link>
      </div>
    </div>
  );
}
```

> æ³¨æ„:Head ç»„ä»¶åº”è¯¥åŒ…å«åœ¨ä»»ä½•é¡µé¢ç»„ä»¶ä¸­ï¼Œé€šå¸¸å°±åœ¨å¼€å§‹æ ‡è®°ä¸­ã€‚æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨çš„ Head ç»„ä»¶ï¼Œå®ƒé€šè¿‡ props æ¥å—åŠ¨æ€å€¼ã€‚

## API è·¯çº¿

æ‚¨çš„é¡¹ç›®éœ€è¦åç«¯/ API å—ï¼Ÿæ²¡é—®é¢˜ã€‚

å…³äº Next çš„ä¸€ä¸ªæ¸¸æˆè§„åˆ™æ”¹å˜è€…æ˜¯ï¼Œå®ƒå¦‚ä½•é€šè¿‡è®©æ‚¨èƒ½å¤Ÿä½¿ç”¨ä¸€ä¸ªç§°ä¸º **API routes** çš„åŠŸèƒ½ç¼–å†™æœåŠ¡å™¨ä»£ç ï¼Œæ¥æä¾›ä¸€ä¸ªç”¨äºåˆ›å»ºå…¨æ ˆ React åº”ç”¨ç¨‹åºçš„ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆã€‚

è¦ç¼–å†™æ‚¨çš„åç«¯ï¼Œè¯·åœ¨/pages ä¸­æ·»åŠ ä¸€ä¸ªåä¸ºâ€œapiâ€çš„æ–‡ä»¶å¤¹æ¥åˆ›å»ºæ‚¨è‡ªå·±çš„ APIï¼Œè¿™äº› API æœ€ç»ˆå°†ä½œä¸ºå•ç‹¬çš„æ— æœåŠ¡å™¨å‡½æ•°æ¥æ‰§è¡Œã€‚

å¦‚æœæˆ‘ä»¬æƒ³ä»/api/about ä¸­è·å– about é¡µé¢çš„æ•°æ®ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨/pages/api ä¸­åŒ…å«ä¸€ä¸ªåä¸º about.js çš„é¡µé¢:

```
// syntax is very similar to the "Express" Node.js framework

// here we are responding to every request with an OK (200) code and sending JSON data back (our name)

export default function handler(req, res) {
  res.status(200).json({ name: "Reed Barger" });
} 
```

## è¯·æ±‚æ•°æ®å®¢æˆ·ç«¯

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª API è·¯ç”±ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒå‘¢ï¼Ÿ

æˆ‘ä»¬å¦‚ä½•ä» API è·¯ç”±ä¸­è¯·æ±‚æ•°æ®ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯é¡µé¢ä¸­ä½¿ç”¨è¿™äº›æ•°æ®ï¼Ÿ

ä¼ ç»Ÿçš„æ–¹æ³•æ˜¯ä½¿ç”¨`useEffect`å’Œ`useState`è¯·æ±‚å®ƒ:

```
import Link from "next/link";
import { useEffect, useState } from "react";

export default function About() {
  const [data, setData] = useState(null);
  const [isLoading, setLoading] = useState(false);

  useEffect(() => {
    setLoading(true);
    fetch("api/about")
      .then((res) => res.json())
      .then((data) => {
        setData(data);
        setLoading(false);
      });
  }, []);

  if (isLoading) return <p>Loading...</p>;
  if (!data) return <p>No about data</p>;

  return (
    <div>
      <h1>My name is: {data.name}</h1>
    </div>
  );
}
```

è¿™ç§æ–¹æ³•å¯è¡Œï¼Œä½†æ˜¯éœ€è¦å¤§é‡æ ·æ¿ä»£ç ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒæ²¡æœ‰æœ€å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

è™½ç„¶è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦è·å–å¿…è¦çš„åŠ¨æ€ä¿¡æ¯å¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šåœ¨æ¯æ¬¡é¡µé¢è®¿é—®æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºâ€œæ­£åœ¨åŠ è½½â€çš„æ–‡æœ¬ã€‚

è·å–æ•°æ®å¹¶åœ¨å°†æ¥è®¿é—®æ—¶æ•è·æ•°æ®çš„ä¸€ç§æ”¹è¿›æ–¹æ³•æ˜¯ä½¿ç”¨ SWR åº“ï¼Œå®ƒä¹Ÿæ˜¯ç”± Next çš„å¼€å‘è€…å¼€å‘çš„ã€‚

å®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„é’©å­`useSWR`,å¯ä»¥æ›´å®¹æ˜“åœ°è·å–æ•°æ®ï¼Œå¤„ç†åŠ è½½å’Œé”™è¯¯çŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œè¿˜å¯ä»¥ç¼“å­˜æ•°æ®ä¾›å°†æ¥è®¿é—®ã€‚å¦‚æœå®ƒå·²ç»æ›´æ”¹ï¼Œè¯·åœ¨åå°è·å–æ•°æ®ï¼ŒåŒæ—¶ä»ç¼“å­˜ä¸­æ˜¾ç¤ºè¿‡æ—¶çš„æ•°æ®ã€‚

> æ³¨æ„:è¿™ä¸ªé’©å­æ˜¯ä»¥è¿™ä¸ªâ€œç¼“å­˜å¤±æ•ˆâ€ç­–ç•¥å‘½åçš„:â€œå¤±æ•ˆæ—¶é‡æ–°éªŒè¯â€

ä¸‹é¢æ˜¯ä½¿ç”¨ SWR æå‡ºçš„ç›¸åŒè¯·æ±‚:

```
import useSWR from "swr";

const fetcher = (...args) => fetch(...args).then((res) => res.json())

export default function About() {
  const { data, error } = useSWR("/api/about", fetcher)

  if (error) return <div>Error fetching data</div>
  if (!data) return <div>Loading...</div>

  return (
    <div>
      <h1>{data.name}</h1>
    </div>
  )
}
```

## è¯·æ±‚æ•°æ®æœåŠ¡å™¨ç«¯

åœ¨ Next ä¸­ï¼Œæœ‰ä»€ä¹ˆæ›´å¥½çš„è·å–æ•°æ®çš„æ–¹æ³•æ¥æ”¹å–„ç”¨æˆ·ä½“éªŒå’Œæ•´ä½“ SEO å‘¢ï¼Ÿ

æœ‰ä¸¤ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥åŒ…å«åœ¨é¡µé¢æ–‡ä»¶ä¸­ï¼Œå…è®¸æˆ‘ä»¬ä»æœåŠ¡å™¨è·å–æ•°æ®:

> æ˜¯çš„ï¼Œè¿™äº›å‡½æ•°ä¸æˆ‘ä»¬çš„ React ç»„ä»¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å®ƒä»¬çš„ä»£ç ä¸æˆ‘ä»¬çš„ React å®¢æˆ·ç«¯æ˜¯åˆ†å¼€æ†ç»‘çš„ã€‚

1.  `getServerSideProps`
2.  `getStaticProps`

## GetServerSideProps

`getServerSideProps`è¿è¡Œåœ¨æ¯ä¸€æ¬¡é¡µé¢è®¿é—®ä¸­ã€‚å› æ­¤ï¼Œå®ƒå¯¹äºåŒ…å«åŠ¨æ€æ•°æ®æˆ–æ¯æ¬¡éƒ½éœ€è¦æ‰§è¡Œè¯·æ±‚çš„é¡µé¢éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚è·å–ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æ•°æ®ã€‚

```
export default function About({ name }) {
  return (
    <div>
      <h1>My name is: {name}</h1>
    </div>
  );
}

export function getServerSideProps() {
  return {
    props: { name: "Reed Barger" },
  };
}
```

è¯¥å‡½æ•°æ­£å¦‚å…¶åç§°æ‰€è¿°â€”â€”å®ƒè®©æˆ‘ä»¬ä»æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°é¡µé¢ç»„ä»¶çš„ props ä¸­ã€‚

è¿™ä¸ªç‰¹æ€§çš„ä¼Ÿå¤§ä¹‹å¤„åœ¨äºï¼Œå®ƒå…è®¸æˆ‘ä»¬çš„ React å®¢æˆ·ç«¯ç«‹å³æ˜¾ç¤ºæ•°æ®ï¼Œæ²¡æœ‰å»¶è¿Ÿï¼Œè€Œä¸”ä¸éœ€è¦å¤„ç†ä»»ä½•åŠ è½½æˆ–é”™è¯¯çŠ¶æ€ã€‚

å¦‚æœæˆ‘ä»¬æƒ³ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å…³é”®å­—`async`ä½¿`getServerSideProps`å¼‚æ­¥æ¥å®ç°ã€‚

```
export default function About({ name }) {
  return (
    <div>
      <h1>My name is: {name}</h1>
    </div>
  );
}

export async function getServerSideProps() {
  const data = await fetch("https://randomuser.me/api").then((res) =>
    res.json()
  );

  return {
    props: { name: data.results[0].name.first },
  };
}
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åŠ¨æ€åœ°ä»[éšæœºç”¨æˆ· api](https://randomuser.me) è·å–æ•°æ®ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„æ•°æ®åœ¨æ¯æ¬¡åˆ·æ–°é¡µé¢æ—¶éƒ½ä¼šæ”¹å˜ã€‚

## GetStaticProps

è®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„`getServerSideProps`å‡½æ•°é‡å‘½åä¸º`getStaticProps`ã€‚

åŒæ ·ï¼Œè¯¥å‡½æ•°å¦‚å…¶åæ‰€ç¤ºã€‚æ˜¯å—ï¼Ÿ

`getStaticProps`æ˜¯ä¸€ä¸ªæ›´é€‚åˆå˜åŒ–ä¸å¤ªé¢‘ç¹çš„é™æ€é¡µé¢çš„å‡½æ•°ã€‚è¯¥å‡½æ•°æ‰§è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨ä»£ç ï¼Œå¹¶åœ¨æœåŠ¡å™¨ä¸Šå‘å‡º GET è¯·æ±‚ï¼Œä½†å®ƒåªåœ¨æˆ‘ä»¬çš„é¡¹ç›®æ„å»ºæ—¶æ‰§è¡Œä¸€æ¬¡ã€‚

ç„¶è€Œï¼Œå½“æ‚¨åœ¨å¼€å‘ä¸­è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼¼ä¹ä¼šåœ¨æˆ‘ä»¬æ¯æ¬¡åƒ`getServerSideProps`ä¸€æ ·åˆ·æ–°é¡µé¢æ—¶è¯·æ±‚æ•°æ®ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯`getStaticProps` *åªåœ¨å¼€å‘*æœŸé—´å¯¹æ¯ä¸ªé¡µé¢è®¿é—®å‘å‡ºè¯·æ±‚ã€‚

å¦‚æœæ‚¨è¿è¡Œ`yarn build`ï¼Œç„¶åä½¿ç”¨`yarn start`è¿è¡Œç”Ÿäº§æ„å»ºæˆ– React é¡¹ç›®ï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ï¼Œæ— è®ºæˆ‘ä»¬åˆ·æ–°å¤šå°‘æ¬¡ï¼Œæˆ‘ä»¬éƒ½ä¼šè·å¾—ç›¸åŒçš„åç§°â€”â€”åœ¨é¡¹ç›®æ„å»ºæ—¶è€Œä¸æ˜¯è¿è¡Œæ—¶è¯·æ±‚çš„åç§°ã€‚

![Screen-Shot-2022-01-14-at-3.59.19-PM](img/418314181f8843061ee0a9ec199b7d89.png)

Sample result requested from getStaticProps

æ­¤æ—¶æ‚¨å¯èƒ½ä¼šé—®:*â€œè¿™ä¸¤ä¸ªå‡½æ•°ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ API è·¯ç”±å‘¢ï¼Ÿâ€*

é‡è¦çš„æ˜¯è¦æ„è¯†åˆ°è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³`getServerSideProps`å’Œ`getStaticProps`éƒ½åªèƒ½æ‰§è¡Œ GET è¯·æ±‚ã€‚API è·¯ç”±å¯ä»¥å¤„ç†ä»»ä½•ç±»å‹çš„è¯»å–å’Œæ›´æ–°æ•°æ®çš„è¯·æ±‚(å³å½“ä¸æ•°æ®åº“ç­‰æ•°æ®å±‚ç»“åˆæ—¶)

## ä¸‹ä¸€æ­¥å»å“ªé‡Œå­¦. js

æˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºçš„åªæ˜¯å¯¹ Next çš„çš®æ¯›ï¼Œä½†æ˜¯æ‚¨å·²ç»è·å¾—äº†åœ¨ä»Šå¤©çš„ React é¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨ Next æ‰€éœ€çš„ä¸€åˆ‡ã€‚

å¦‚æœä½ æƒ³è¦æ›´æ·±å…¥çš„æŠ€æœ¯æŒ‡å¯¼ï¼Œå®˜æ–¹ç½‘ç«™æœ‰ä¸€ä¸ªå…³äºå¦‚ä½•ä»å¤´å¼€å§‹å­¦ä¹  Next.js çš„äº’åŠ¨è¯¾ç¨‹ã€‚

![Screen-Shot-2022-01-14-at-12.05.33-PM](img/98c3365a4af49c0a8c2d0e51f805d540.png)

The (free) Next.js Learn Course

å¦‚æœä½ å‡†å¤‡å¥½é‡‡å–â€œä¸‹ä¸€æ­¥â€å¹¶æƒ³ä»å¤´å¼€å§‹æ„å»ºå…¨é¢çš„ React åº”ç”¨ç¨‹åºï¼Œè¯·æŸ¥çœ‹ React boot camp[**ã€‚**](https://reactbootcamp.com)

æ—¢ç„¶ä½ å¯¹å­¦ä¹  React å¾ˆè®¤çœŸï¼Œæˆ‘å·²ç»æ•´ç†äº†ä¸€ä¸ªå®Œæ•´çš„ç»ˆæèµ„æºï¼Œè®©ä½ æˆä¸º React ä¸“ä¸šäººå£«ï¼Œå‡†å¤‡å¥½:

*   ä»å¼€å§‹åˆ°éƒ¨ç½²ï¼Œæ„å»ºä»¤äººæƒŠå¹çš„ç”Ÿäº§å°±ç»ªå‹åº”ç”¨
*   ä»åŸºæœ¬æ¦‚å¿µåˆ°æœ€æ–°åŠŸèƒ½ï¼Œæ·±åˆ»ç†è§£ React
*   *æˆä¸ºç‚™æ‰‹å¯çƒ­çš„å¼€å‘è€…ï¼Œæ‹¥æœ‰ 6 ä½æ•°çš„è–ªæ°´*

*å¦‚æœä½ å¯¹è¿™äº›æ„Ÿå…´è¶£ï¼Œè¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ React è®­ç»ƒè¥:*

*[![The React Bootcamp](img/8879fb8f279f64aae3696886c5d25bc4.png)](http://bit.ly/join-react-bootcamp) 
*æ‰“å¼€æ—¶ç‚¹å‡»æ­¤å¤„é€šçŸ¥**